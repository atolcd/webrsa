SET client_encoding = 'UTF8';
SET standard_conforming_strings = off;
SET check_function_bodies = false;
SET client_min_messages = warning;
SET escape_string_warning = off;
SET search_path = public, pg_catalog;
SET default_tablespace = '';
SET default_with_oids = false;

-- *****************************************************************************
BEGIN;
-- *****************************************************************************

--------------------------------------------------------------------------------
-- Tag
--------------------------------------------------------------------------------
DELETE FROM categorietags WHERE name = 'Doublons complexes';
INSERT INTO categorietags (name, created, modified) VALUES ('Doublons complexes', NOW(), NOW());
DELETE FROM valeurstags WHERE name = 'N''est pas un doublon';
INSERT INTO valeurstags (name, categorietag_id, created, modified) VALUES (
	'N''est pas un doublon', 
	(SELECT id FROM categorietags WHERE name = 'Doublons complexes' LIMIT 1), 
	NOW(), 
	NOW()
);

--------------------------------------------------------------------------------
-- Requestmanager, nouveaux moteurs
--
-- NOTE: Pour récupérer une requète existante : lib/Cake/Model/Model.php:2633
-- Ajouter : $this->log(pg_escape_string(json_encode($query)));
--------------------------------------------------------------------------------

DELETE FROM requestsmanager WHERE requestsmanager.requestgroup_id IN (
	SELECT requestgroups.id
	FROM requestgroups
	WHERE requestgroups.name = 'Moteurs de recherche'
	LIMIT 1
);

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par Dossier', 1, 1, 'Dossier', '{"conditions":{"OR":{"Prestation.rolepers":["DEM","CJT"],"0":"Prestation.id IS NULL"},"0":"Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)","1":[]},"fields":{"0":"Dossier.id","Personne.dtnai":"Personne.dtnai","Personne.nir":"Personne.nir","( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" || '' '' || COALESCE( \"Personne\".\"prenom2\", '''' ) || '' '' || COALESCE( \"Personne\".\"prenom3\", '''' ) ) AS  \"Personne__nom_complet_prenoms\"":"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" || '' '' || COALESCE( \"Personne\".\"prenom2\", '''' ) || '' '' || COALESCE( \"Personne\".\"prenom3\", '''' ) ) AS  \"Personne__nom_complet_prenoms\"","Prestation.rolepers":"Prestation.rolepers","Adresse.numcom":"Adresse.numcom","COALESCE( \"Adresse\".\"numvoie\", '''' ) || '' '' || COALESCE( \"Adresse\".\"libtypevoie\", '''' ) || '' '' || COALESCE( \"Adresse\".\"nomvoie\", '''' ) || E''\\n'' || COALESCE( \"Adresse\".\"codepos\", '''' ) || '' '' || COALESCE( \"Adresse\".\"nomcom\", '''' ) AS  \"Adresse__complete\"":"COALESCE( \"Adresse\".\"numvoie\", '''' ) || '' '' || COALESCE( \"Adresse\".\"libtypevoie\", '''' ) || '' '' || COALESCE( \"Adresse\".\"nomvoie\", '''' ) || E''\\n'' || COALESCE( \"Adresse\".\"codepos\", '''' ) || '' '' || COALESCE( \"Adresse\".\"nomcom\", '''' ) AS  \"Adresse__complete\"","Dossier.numdemrsa":"Dossier.numdemrsa","Dossier.dtdemrsa":"Dossier.dtdemrsa","Dossier.matricule":"Dossier.matricule","Situationdossierrsa.etatdosrsa":"Situationdossierrsa.etatdosrsa","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Structurereferenteparcours.lib_struc":"Structurereferenteparcours.lib_struc","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 12:04:29'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"personnes\"","alias":"Personne","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"LEFT OUTER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"LEFT OUTER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA''"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"INNER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"dsps\"","alias":"Dsp","type":"LEFT OUTER","conditions":"\"Dsp\".\"personne_id\" = \"Personne\".\"id\" AND \"Dsp\".\"id\" IN ( SELECT \"dsps\".\"id\" AS dsps__id FROM dsps AS dsps   WHERE \"dsps\".\"personne_id\" = \"Personne\".\"id\"   ORDER BY \"dsps\".\"id\" DESC  LIMIT 1 )"},{"table":"\"dsps_revs\"","alias":"DspRev","type":"LEFT OUTER","conditions":"\"DspRev\".\"personne_id\" = \"Personne\".\"id\" AND \"DspRev\".\"id\" IN ( SELECT \"tmp_dsps_revs\".\"id\" AS tmp_dsps_revs__id FROM dsps_revs AS tmp_dsps_revs   WHERE \"tmp_dsps_revs\".\"personne_id\" = \"Personne\".\"id\"   ORDER BY \"tmp_dsps_revs\".\"modified\" DESC  LIMIT 1 )"},{"table":"\"orientsstructs\"","alias":"Orientstruct","type":"LEFT OUTER","conditions":"\"Orientstruct\".\"personne_id\" = \"Personne\".\"id\" AND \"Orientstruct\".\"statut_orient\" = ''Orient\u00e9'' AND \"Orientstruct\".\"id\" IN ( SELECT \"orientsstructs\".\"id\" AS orientsstructs__id FROM orientsstructs AS orientsstructs   WHERE \"orientsstructs\".\"personne_id\" = \"Personne\".\"id\" AND \"orientsstructs\".\"statut_orient\" = ''Orient\u00e9'' AND \"orientsstructs\".\"date_valid\" IS NOT NULL   ORDER BY \"orientsstructs\".\"date_valid\" DESC  LIMIT 1 )"},{"table":"\"structuresreferentes\"","alias":"Structurereferente","type":"LEFT OUTER","conditions":"\"Orientstruct\".\"structurereferente_id\" = \"Structurereferente\".\"id\""},{"table":"\"typesorients\"","alias":"Typeorient","type":"LEFT OUTER","conditions":"\"Orientstruct\".\"typeorient_id\" = \"Typeorient\".\"id\""}],"limit":11,"offset":0,"order":[["Personne.nom"]],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par Orientation', 1, 1, 'Orientstruct', '{"conditions":[{"OR":["Informationpe.id IS NULL","Informationpe.id IN ( SELECT \"derniereinformationspe\".\"i__id\" FROM ( SELECT \"i\".\"id\" AS \"i__id\", \"h\".\"date\" AS \"h__date\" FROM \"informationspe\" AS \"i\" INNER JOIN \"public\".\"historiqueetatspe\" AS \"h\" ON (\"h\".\"informationpe_id\" = \"i\".\"id\")  WHERE ((((\"i\".\"nir\" IS NOT NULL)  AND  (\"Personne\".\"nir\" IS NOT NULL)  AND  (TRIM( BOTH '' '' FROM \"i\".\"nir\" ) <> '''')  AND  (TRIM( BOTH '' '' FROM \"Personne\".\"nir\" ) <> '''')  AND  (SUBSTRING( \"i\".\"nir\" FROM 1 FOR 13 ) = SUBSTRING( \"Personne\".\"nir\" FROM 1 FOR 13 ))  AND  (\"i\".\"dtnai\" = \"Personne\".\"dtnai\"))) OR (((\"i\".\"nom\" IS NOT NULL)  AND  (\"Personne\".\"nom\" IS NOT NULL)  AND  (\"i\".\"prenom\" IS NOT NULL)  AND  (\"Personne\".\"prenom\" IS NOT NULL)  AND  (TRIM( BOTH '' '' FROM \"i\".\"nom\" ) <> '''')  AND  (TRIM( BOTH '' '' FROM \"i\".\"prenom\" ) <> '''')  AND  (TRIM( BOTH '' '' FROM \"Personne\".\"nom\" ) <> '''')  AND  (TRIM( BOTH '' '' FROM \"Personne\".\"prenom\" ) <> '''')  AND  (TRIM( BOTH '' '' FROM \"i\".\"nom\" ) = \"Personne\".\"nom\")  AND  (TRIM( BOTH '' '' FROM \"i\".\"prenom\" ) = \"Personne\".\"prenom\")  AND  (\"i\".\"dtnai\" = \"Personne\".\"dtnai\")))) AND \"h\".\"id\" IN ( SELECT \"dernierhistoriqueetatspe\".\"id\" AS dernierhistoriqueetatspe__id FROM historiqueetatspe AS dernierhistoriqueetatspe   WHERE \"dernierhistoriqueetatspe\".\"informationpe_id\" = \"i\".\"id\"   ORDER BY \"dernierhistoriqueetatspe\".\"date\" DESC, \"dernierhistoriqueetatspe\".\"id\" DESC  LIMIT 1 )    ) AS \"derniereinformationspe\" ORDER BY \"derniereinformationspe\".\"h__date\" DESC LIMIT 1 )"]},"Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)",[]],"fields":{"Personne.nomcomnai":"Personne.nomcomnai","Personne.dtnai":"Personne.dtnai","Personne.nir":"Personne.nir","( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"":"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"","Calculdroitrsa.toppersdrodevorsa":"Calculdroitrsa.toppersdrodevorsa","Prestation.rolepers":"Prestation.rolepers","Adresse.numcom":"Adresse.numcom","Adresse.nomcom":"Adresse.nomcom","Dossier.numdemrsa":"Dossier.numdemrsa","Dossier.dtdemrsa":"Dossier.dtdemrsa","Situationdossierrsa.etatdosrsa":"Situationdossierrsa.etatdosrsa","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Structurereferenteparcours.lib_struc":"Structurereferenteparcours.lib_struc","Orientstruct.date_valid":"Orientstruct.date_valid","Orientstruct.statut_orient":"Orientstruct.statut_orient","Typeorient.lib_type_orient":"Typeorient.lib_type_orient","Structurereferente.lib_struc":"Structurereferente.lib_struc","Historiqueetatpe.identifiantpe":"Historiqueetatpe.identifiantpe","Modecontact.numtel":"Modecontact.numtel","0":"Orientstruct.id","1":"Orientstruct.personne_id","2":"Orientstruct.date_propo","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:12:14'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"personnes\"","alias":"Personne","type":"INNER","conditions":"\"Orientstruct\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"INNER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"LEFT OUTER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA''"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"LEFT OUTER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"typesorients\"","alias":"Typeorient","type":"LEFT OUTER","conditions":"\"Orientstruct\".\"typeorient_id\" = \"Typeorient\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferente","type":"LEFT OUTER","conditions":"\"Orientstruct\".\"structurereferente_id\" = \"Structurereferente\".\"id\""},{"table":"informationspe","alias":"Informationpe","type":"LEFT OUTER","foreignKey":false,"conditions":{"OR":[["Informationpe.nir IS NOT NULL","SUBSTRING( Informationpe.nir FROM 1 FOR 13 ) = SUBSTRING( TRIM( BOTH '' '' FROM Personne.nir ) FROM 1 FOR 13 )","Informationpe.dtnai = Personne.dtnai"],{"0":"Personne.nom IS NOT NULL","1":"Personne.prenom IS NOT NULL","2":"Personne.dtnai IS NOT NULL","TRIM( BOTH '' '' FROM Personne.nom ) <>":"","TRIM( BOTH '' '' FROM Personne.prenom ) <>":"","3":"TRIM( BOTH '' '' FROM Informationpe.nom ) = TRIM( BOTH '' '' FROM Personne.nom )","4":"TRIM( BOTH '' '' FROM Informationpe.prenom ) = TRIM( BOTH '' '' FROM Personne.prenom )","5":"Informationpe.dtnai = Personne.dtnai"}]}},{"table":"historiqueetatspe","alias":"Historiqueetatpe","type":"LEFT OUTER","foreignKey":false,"conditions":["Historiqueetatpe.informationpe_id = Informationpe.id","Historiqueetatpe.id IN (\n\t\t\t\t\tSELECT\n\t\t\t\t\t\t\thistoriqueetatspe.id\n\t\t\t\t\t\tFROM historiqueetatspe\n\t\t\t\t\t\tWHERE historiqueetatspe.informationpe_id = Informationpe.id\n\t\t\t\t\t\tORDER BY historiqueetatspe.date DESC,  historiqueetatspe.id DESC\n\t\t\t\t\t\tLIMIT 1\n\t\t\t\t)"]},{"table":"\"modescontact\"","alias":"Modecontact","type":"LEFT OUTER","conditions":"\"Modecontact\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Modecontact\".\"id\" IN ( SELECT \"modescontact\".\"id\" AS modescontact__id FROM modescontact AS modescontact   WHERE \"modescontact\".\"foyer_id\" = \"Foyer\".\"id\"   ORDER BY \"modescontact\".\"id\" DESC  LIMIT 1 )"}],"limit":11,"offset":0,"order":[""],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par APRE', 1, 1, 'Apre', '{"conditions":["Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)",[]],"fields":{"Personne.dtnai":"Personne.dtnai","Personne.nir":"Personne.nir","( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"":"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"","Adresse.numcom":"Adresse.numcom","Adresse.nomcom":"Adresse.nomcom","Dossier.numdemrsa":"Dossier.numdemrsa","Dossier.matricule":"Dossier.matricule","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Structurereferenteparcours.lib_struc":"Structurereferenteparcours.lib_struc","Apre.numeroapre":"Apre.numeroapre","Apre.activitebeneficiaire":"Apre.activitebeneficiaire","Apre.etatdossierapre":"Apre.etatdossierapre","Apre.isdecision":"Apre.isdecision","Structurereferente.lib_struc":"Structurereferente.lib_struc","( \"Referent\".\"qual\" || '' '' || \"Referent\".\"nom\" || '' '' || \"Referent\".\"prenom\" ) AS  \"Referent__nom_complet\"":"( \"Referent\".\"qual\" || '' '' || \"Referent\".\"nom\" || '' '' || \"Referent\".\"prenom\" ) AS  \"Referent__nom_complet\"","0":"Apre.id","1":"Apre.personne_id","2":"Apre.datedemandeapre","Aideapre66.datedemande":"Aideapre66.datedemande","Aideapre66.decisionapre":"Aideapre66.decisionapre","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:13:04'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"personnes\"","alias":"Personne","type":"INNER","conditions":"\"Apre\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"LEFT OUTER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"INNER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA'' AND \"Prestation\".\"rolepers\" IN (''DEM'', ''CJT'')"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"INNER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"INNER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"LEFT OUTER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferente","type":"INNER","conditions":"\"Apre\".\"structurereferente_id\" = \"Structurereferente\".\"id\""},{"table":"\"referents\"","alias":"Referent","type":"INNER","conditions":"\"Apre\".\"referent_id\" = \"Referent\".\"id\""},{"table":"\"aidesapres66\"","alias":"Aideapre66","type":"LEFT OUTER","conditions":"\"Aideapre66\".\"apre_id\" = \"Apre\".\"id\""},{"table":"\"themesapres66\"","alias":"Themeapre66","type":"LEFT OUTER","conditions":"\"Aideapre66\".\"themeapre66_id\" = \"Themeapre66\".\"id\""},{"table":"\"typesaidesapres66\"","alias":"Typeaideapre66","type":"LEFT OUTER","conditions":"\"Aideapre66\".\"typeaideapre66_id\" = \"Typeaideapre66\".\"id\""}],"limit":11,"offset":0,"order":[""],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par CER', 1, 1, 'Contratinsertion', '{"conditions":["Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)",[]],"fields":{"Personne.dtnai":"Personne.dtnai","Personne.nir":"Personne.nir","( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"":"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"","Prestation.rolepers":"Prestation.rolepers","Adresse.numcom":"Adresse.numcom","Adresse.nomcom":"Adresse.nomcom","Dossier.matricule":"Dossier.matricule","Situationdossierrsa.etatdosrsa":"Situationdossierrsa.etatdosrsa","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Structurereferenteparcours.lib_struc":"Structurereferenteparcours.lib_struc","Contratinsertion.df_ci":"Contratinsertion.df_ci","Contratinsertion.rg_ci":"Contratinsertion.rg_ci","Contratinsertion.decision_ci":"Contratinsertion.decision_ci","Contratinsertion.datevalidation_ci":"Contratinsertion.datevalidation_ci","Contratinsertion.forme_ci":"Contratinsertion.forme_ci","Contratinsertion.positioncer":"Contratinsertion.positioncer","Contratinsertion.created":"Contratinsertion.created","( \"Referent\".\"qual\" || '' '' || \"Referent\".\"nom\" || '' '' || \"Referent\".\"prenom\" ) AS  \"Referent__nom_complet\"":"( \"Referent\".\"qual\" || '' '' || \"Referent\".\"nom\" || '' '' || \"Referent\".\"prenom\" ) AS  \"Referent__nom_complet\"","0":"Contratinsertion.id","1":"Contratinsertion.personne_id","2":"Contratinsertion.dd_ci","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:13:33'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"personnes\"","alias":"Personne","type":"INNER","conditions":"\"Contratinsertion\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"LEFT OUTER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"LEFT OUTER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA''"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"INNER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferente","type":"LEFT OUTER","conditions":"\"Contratinsertion\".\"structurereferente_id\" = \"Structurereferente\".\"id\""},{"table":"\"referents\"","alias":"Referent","type":"LEFT OUTER","conditions":"\"Contratinsertion\".\"referent_id\" = \"Referent\".\"id\""},{"table":"\"orientsstructs\"","alias":"Orientstruct","type":"LEFT OUTER","conditions":"\"Orientstruct\".\"personne_id\" = \"Personne\".\"id\" AND \"Orientstruct\".\"id\" IN ( SELECT \"orientsstructs\".\"id\" AS orientsstructs__id FROM orientsstructs AS orientsstructs   WHERE \"orientsstructs\".\"personne_id\" = \"Personne\".\"id\" AND \"orientsstructs\".\"statut_orient\" = ''Orient\u00e9'' AND \"orientsstructs\".\"date_valid\" IS NOT NULL   ORDER BY \"orientsstructs\".\"date_valid\" DESC  LIMIT 1 )"},{"table":"\"typesorients\"","alias":"Typeorient","type":"LEFT OUTER","conditions":"\"Orientstruct\".\"typeorient_id\" = \"Typeorient\".\"id\""}],"limit":10,"offset":null,"order":[["Contratinsertion.df_ci"]],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par Contrat Unique d''Insertion', 1, 1, 'Cui', '{"conditions":["Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)",[]],"fields":{"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"":"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"","Adresse.nomcom":"Adresse.nomcom","Dossier.matricule":"Dossier.matricule","Cui.effetpriseencharge":"Cui.effetpriseencharge","Cui.finpriseencharge":"Cui.finpriseencharge","Emailcui.textmailcui66_id":"Emailcui.textmailcui66_id","Emailcui.dateenvoi":"Emailcui.dateenvoi","Partenairecui.raisonsociale":"Partenairecui.raisonsociale","0":"Cui.id","1":"Cui.personne_id","2":"Cui.faitle","Cui66.etatdossiercui66":"Cui66.etatdossiercui66","Decisioncui66.decision":"Decisioncui66.decision","Decisioncui66.datedecision":"Decisioncui66.datedecision","Historiquepositioncui66.created":"Historiquepositioncui66.created","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:14:19'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"entreesromesv3\"","alias":"Entreeromev3","type":"LEFT OUTER","conditions":"\"Cui\".\"entreeromev3_id\" = \"Entreeromev3\".\"id\""},{"table":"\"partenairescuis\"","alias":"Partenairecui","type":"LEFT OUTER","conditions":"\"Cui\".\"partenairecui_id\" = \"Partenairecui\".\"id\""},{"table":"\"emailscuis\"","alias":"Emailcui","type":"LEFT OUTER","conditions":"\"Emailcui\".\"cui_id\" = \"Cui\".\"id\" AND \"Emailcui\".\"id\" IN ( SELECT \"emailscuis\".\"id\" AS emailscuis__id FROM emailscuis AS emailscuis   WHERE \"emailscuis\".\"cui_id\" = \"Cui\".\"id\" AND \"emailscuis\".\"dateenvoi\" IS NOT NULL   ORDER BY \"emailscuis\".\"dateenvoi\" DESC  LIMIT 1 )"},{"table":"\"adressescuis\"","alias":"Adressecui","type":"LEFT OUTER","conditions":"\"Partenairecui\".\"adressecui_id\" = \"Adressecui\".\"id\""},{"table":"\"personnes\"","alias":"Personne","type":"INNER","conditions":"\"Cui\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"LEFT OUTER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"INNER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA'' AND \"Prestation\".\"rolepers\" IN (''DEM'', ''CJT'')"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"INNER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"cuis66\"","alias":"Cui66","type":"INNER","conditions":"\"Cui66\".\"cui_id\" = \"Cui\".\"id\""},{"table":"\"accompagnementscuis66\"","alias":"Accompagnementcui66","type":"LEFT OUTER","conditions":"\"Accompagnementcui66\".\"cui66_id\" = \"Cui66\".\"id\" AND \"Accompagnementcui66\".\"id\" IN ( SELECT \"accompagnementscuis66\".\"id\" AS accompagnementscuis66__id FROM accompagnementscuis66 AS accompagnementscuis66   WHERE \"accompagnementscuis66\".\"cui66_id\" = \"Cui66\".\"id\"   ORDER BY \"accompagnementscuis66\".\"created\" DESC  LIMIT 1 )"},{"table":"\"decisionscuis66\"","alias":"Decisioncui66","type":"LEFT OUTER","conditions":"\"Decisioncui66\".\"cui66_id\" = \"Cui66\".\"id\" AND \"Decisioncui66\".\"id\" IN ( SELECT \"decisionscuis66\".\"id\" AS decisionscuis66__id FROM decisionscuis66 AS decisionscuis66   WHERE \"decisionscuis66\".\"cui66_id\" = \"Cui66\".\"id\"   ORDER BY \"decisionscuis66\".\"created\" DESC  LIMIT 1 )"},{"table":"\"propositionscuis66\"","alias":"Propositioncui66","type":"LEFT OUTER","conditions":"\"Propositioncui66\".\"cui66_id\" = \"Cui66\".\"id\" AND \"Propositioncui66\".\"id\" IN ( SELECT \"propositionscuis66\".\"id\" AS propositionscuis66__id FROM propositionscuis66 AS propositionscuis66   WHERE \"propositionscuis66\".\"cui66_id\" = \"Cui66\".\"id\"   ORDER BY \"propositionscuis66\".\"created\" DESC  LIMIT 1 )"},{"table":"\"rupturescuis66\"","alias":"Rupturecui66","type":"LEFT OUTER","conditions":"\"Rupturecui66\".\"cui66_id\" = \"Cui66\".\"id\" AND \"Rupturecui66\".\"id\" IN ( SELECT \"rupturescuis66\".\"id\" AS rupturescuis66__id FROM rupturescuis66 AS rupturescuis66   WHERE \"rupturescuis66\".\"cui66_id\" = \"Cui66\".\"id\"   ORDER BY \"rupturescuis66\".\"created\" DESC  LIMIT 1 )"},{"table":"\"suspensionscuis66\"","alias":"Suspensioncui66","type":"LEFT OUTER","conditions":"\"Suspensioncui66\".\"cui66_id\" = \"Cui66\".\"id\" AND \"Suspensioncui66\".\"id\" IN ( SELECT \"suspensionscuis66\".\"id\" AS suspensionscuis66__id FROM suspensionscuis66 AS suspensionscuis66   WHERE \"suspensionscuis66\".\"cui66_id\" = \"Cui66\".\"id\"   ORDER BY \"suspensionscuis66\".\"created\" DESC  LIMIT 1 )"},{"table":"\"historiquepositionscuis66\"","alias":"Historiquepositioncui66","type":"LEFT OUTER","conditions":"\"Historiquepositioncui66\".\"cui66_id\" = \"Cui66\".\"id\" AND \"Historiquepositioncui66\".\"id\" IN ( SELECT \"historiquepositionscuis66\".\"id\" AS historiquepositionscuis66__id FROM historiquepositionscuis66 AS historiquepositionscuis66   WHERE \"historiquepositionscuis66\".\"cui66_id\" = \"Cui66\".\"id\"   ORDER BY \"historiquepositionscuis66\".\"created\" DESC  LIMIT 1 )"}],"limit":11,"offset":0,"order":[["Personne.nom","Personne.prenom","Cui.id"]],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par Entretien', 1, 1, 'Entretien', '{"conditions":["Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)",[]],"fields":{"0":"Dossier.id","1":"Entretien.id","2":"Personne.id","3":"Entretien.personne_id","Personne.dtnai":"Personne.dtnai","Personne.nir":"Personne.nir","( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"":"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"","Adresse.codepos":"Adresse.codepos","Adresse.numcom":"Adresse.numcom","Adresse.nomcom":"Adresse.nomcom","Dossier.matricule":"Dossier.matricule","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Structurereferenteparcours.lib_struc":"Structurereferenteparcours.lib_struc","Entretien.dateentretien":"Entretien.dateentretien","Entretien.typeentretien":"Entretien.typeentretien","Entretien.arevoirle":"Entretien.arevoirle","Objetentretien.name":"Objetentretien.name","( \"Referent\".\"qual\" || '' '' || \"Referent\".\"nom\" || '' '' || \"Referent\".\"prenom\" ) AS  \"Referent__nom_complet\"":"( \"Referent\".\"qual\" || '' '' || \"Referent\".\"nom\" || '' '' || \"Referent\".\"prenom\" ) AS  \"Referent__nom_complet\"","Structurereferente.lib_struc":"Structurereferente.lib_struc","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:14:55'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"personnes\"","alias":"Personne","type":"INNER","conditions":"\"Entretien\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"LEFT OUTER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"INNER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA'' AND \"Prestation\".\"rolepers\" IN (''DEM'', ''CJT'')"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"INNER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"objetsentretien\"","alias":"Objetentretien","type":"INNER","conditions":"\"Entretien\".\"objetentretien_id\" = \"Objetentretien\".\"id\""},{"table":"\"referents\"","alias":"Referent","type":"INNER","conditions":"\"Entretien\".\"referent_id\" = \"Referent\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferente","type":"INNER","conditions":"\"Entretien\".\"structurereferente_id\" = \"Structurereferente\".\"id\""},{"table":"\"typesrdv\"","alias":"Typerdv","type":"LEFT OUTER","conditions":"\"Entretien\".\"typerdv_id\" = \"Typerdv\".\"id\""},{"table":"\"actionscandidats\"","alias":"Actioncandidat","type":"LEFT OUTER","conditions":"\"Entretien\".\"actioncandidat_id\" = \"Actioncandidat\".\"id\""}],"limit":11,"offset":0,"order":[""],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par Fiches de candidature', 1, 1, 'ActioncandidatPersonne', '{"conditions":{"OR":{"Prestation.rolepers":["DEM","CJT"],"0":"Prestation.id IS NULL"},"0":"Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)","1":[]},"fields":{"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"":"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"","Adresse.numcom":"Adresse.numcom","Adresse.nomcom":"Adresse.nomcom","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Structurereferenteparcours.lib_struc":"Structurereferenteparcours.lib_struc","ActioncandidatPersonne.datesignature":"ActioncandidatPersonne.datesignature","ActioncandidatPersonne.positionfiche":"ActioncandidatPersonne.positionfiche","( \"Referent\".\"qual\" || '' '' || \"Referent\".\"nom\" || '' '' || \"Referent\".\"prenom\" ) AS  \"Referent__nom_complet\"":"( \"Referent\".\"qual\" || '' '' || \"Referent\".\"nom\" || '' '' || \"Referent\".\"prenom\" ) AS  \"Referent__nom_complet\"","Actioncandidat.name":"Actioncandidat.name","Partenaire.libstruc":"Partenaire.libstruc","0":"ActioncandidatPersonne.id","1":"ActioncandidatPersonne.personne_id","2":"ActioncandidatPersonne.datebilan","3":"( ARRAY_TO_STRING( ARRAY( SELECT a_m.motifsortie_id FROM actionscandidats_motifssortie AS a_m WHERE a_m.actioncandidat_id = \"Actioncandidat\".\"id\" ), ''_'') ) AS \"ActioncandidatPersonne__motifsortie\"","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:15:40'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"actionscandidats\"","alias":"Actioncandidat","type":"INNER","conditions":"\"ActioncandidatPersonne\".\"actioncandidat_id\" = \"Actioncandidat\".\"id\""},{"table":"\"referents\"","alias":"Referent","type":"INNER","conditions":"\"ActioncandidatPersonne\".\"referent_id\" = \"Referent\".\"id\""},{"table":"\"personnes\"","alias":"Personne","type":"INNER","conditions":"\"ActioncandidatPersonne\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"LEFT OUTER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"LEFT OUTER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA''"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"INNER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"INNER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"LEFT OUTER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"contactspartenaires\"","alias":"Contactpartenaire","type":"INNER","conditions":"\"Actioncandidat\".\"contactpartenaire_id\" = \"Contactpartenaire\".\"id\""},{"table":"\"partenaires\"","alias":"Partenaire","type":"INNER","conditions":"\"Contactpartenaire\".\"partenaire_id\" = \"Partenaire\".\"id\""},{"table":"\"progsfichescandidatures66\"","alias":"Progfichecandidature66","type":"LEFT OUTER","conditions":"\"ActioncandidatPersonne\".\"progfichecandidature66_id\" = \"Progfichecandidature66\".\"id\""}],"limit":11,"offset":0,"order":[""],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par Indus', 1, 1, 'Dossier', '{"conditions":["( Situationdossierrsa.etatdosrsa IN ( ''Z'', ''2'', ''3'', ''4'' ) )","Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)",{"Prestation.rolepers":"DEM","0":{"OR":["IndusConstates.type_allocation IS NOT NULL","IndusTransferesCG.type_allocation IS NOT NULL","RemisesIndus.type_allocation IS NOT NULL"]},"1":{"OR":[{"OR":["IndusConstates.moismoucompta = IndusTransferesCG.moismoucompta","IndusConstates.moismoucompta IS NULL","IndusTransferesCG.moismoucompta IS NULL"]},{"OR":["IndusConstates.moismoucompta = RemisesIndus.moismoucompta","IndusConstates.moismoucompta IS NULL","RemisesIndus.moismoucompta IS NULL"]},{"OR":["IndusTransferesCG.moismoucompta = RemisesIndus.moismoucompta","IndusTransferesCG.moismoucompta IS NULL","RemisesIndus.moismoucompta IS NULL"]}]}},[]],"fields":{"Personne.dtnai":"Personne.dtnai","Personne.nir":"Personne.nir","( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"":"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"","Prestation.rolepers":"Prestation.rolepers","Adresse.codepos":"Adresse.codepos","Adresse.numcom":"Adresse.numcom","Dossier.numdemrsa":"Dossier.numdemrsa","Dossier.matricule":"Dossier.matricule","Dossier.typeparte":"Dossier.typeparte","Situationdossierrsa.etatdosrsa":"Situationdossierrsa.etatdosrsa","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Structurereferenteparcours.lib_struc":"Structurereferenteparcours.lib_struc","0":"Dossier.id","1":"Personne.nom","2":"Personne.prenom","Indu.moismoucompta":"COALESCE(\"IndusConstates\".\"moismoucompta\",\"IndusTransferesCG\".\"moismoucompta\",\"RemisesIndus\".\"moismoucompta\") AS \"Indu__moismoucompta\"","IndusConstates.mtmoucompta":"IndusConstates.mtmoucompta","IndusTransferesCG.mtmoucompta":"IndusTransferesCG.mtmoucompta","RemisesIndus.mtmoucompta":"RemisesIndus.mtmoucompta","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:17:51'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"personnes\"","alias":"Personne","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"INNER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"INNER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA'' AND \"Prestation\".\"rolepers\" IN (''DEM'', ''CJT'')"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"INNER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"detailscalculsdroitsrsa\"","alias":"Detailcalculdroitrsa","type":"LEFT OUTER","conditions":"\"Detailcalculdroitrsa\".\"detaildroitrsa_id\" = \"Detaildroitrsa\".\"id\""},{"table":"\"infosfinancieres\"","alias":"IndusConstates","type":"LEFT OUTER","conditions":"\"IndusConstates\".\"dossier_id\" = \"Dossier\".\"id\" AND \"IndusConstates\".\"type_allocation\" = ''IndusConstates''"},{"table":"\"infosfinancieres\"","alias":"IndusTransferesCG","type":"LEFT OUTER","conditions":"\"IndusTransferesCG\".\"dossier_id\" = \"Dossier\".\"id\" AND \"IndusConstates\".\"type_allocation\" = ''IndusTransferesCG''"},{"table":"\"infosfinancieres\"","alias":"RemisesIndus","type":"LEFT OUTER","conditions":"\"RemisesIndus\".\"dossier_id\" = \"Dossier\".\"id\" AND \"IndusConstates\".\"type_allocation\" = ''RemisesIndus''"}],"limit":11,"offset":0,"order":[""],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par DSPs', 1, 1, 'Personne', '{"conditions":[{"OR":["Dsp.id IS NOT NULL","DspRev.id IS NOT NULL"]},"Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)",[]],"fields":{"0":"Dsp.id","1":"DspRev.id","2":"Personne.id","3":"Dossier.numdemrsa","Personne.nom":"Personne.nom","Personne.prenom":"Personne.prenom","Personne.dtnai":"Personne.dtnai","Personne.numfixe":"Personne.numfixe","Personne.numport":"Personne.numport","Calculdroitrsa.toppersdrodevorsa":"Calculdroitrsa.toppersdrodevorsa","Foyer.sitfam":"Foyer.sitfam","Adresse.nomcom":"Adresse.nomcom","Dossier.matricule":"Dossier.matricule","Situationdossierrsa.etatdosrsa":"Situationdossierrsa.etatdosrsa","Canton.canton":"Canton.canton","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Donnees.nivetu":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN \"Dsp\".\"nivetu\" ELSE \"DspRev\".\"nivetu\" END ) AS \"Donnees__nivetu\"","Donnees.nivdipmaxobt":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN \"Dsp\".\"nivdipmaxobt\" ELSE \"DspRev\".\"nivdipmaxobt\" END ) AS \"Donnees__nivdipmaxobt\"","Donnees.libautrqualipro":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN \"Dsp\".\"libautrqualipro\" ELSE \"DspRev\".\"libautrqualipro\" END ) AS \"Donnees__libautrqualipro\"","Donnees.topengdemarechemploi":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN \"Dsp\".\"topengdemarechemploi\" ELSE \"DspRev\".\"topengdemarechemploi\" END ) AS \"Donnees__topengdemarechemploi\"","Donnees.topmoyloco":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN \"Dsp\".\"topmoyloco\" ELSE \"DspRev\".\"topmoyloco\" END ) AS \"Donnees__topmoyloco\"","Donnees.toppermicondub":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN \"Dsp\".\"toppermicondub\" ELSE \"DspRev\".\"toppermicondub\" END ) AS \"Donnees__toppermicondub\"","Foyer.nbenfants":"( SELECT COUNT(\"prestations\".\"id\") FROM \"prestations\" AS \"prestations\" INNER JOIN \"public\".\"personnes\" AS \"personnes\" ON (\"prestations\".\"personne_id\" = \"personnes\".\"id\")  WHERE \"personnes\".\"foyer_id\" = \"Foyer\".\"id\" AND \"prestations\".\"natprest\" = ''RSA'' AND \"prestations\".\"rolepers\" = ''ENF''    ) AS \"Foyer__nbenfants\"","Donnees.nb_fichiers_lies":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN ( SELECT COUNT(\"fichiermodule\".\"id\") FROM \"fichiersmodules\" AS \"fichiermodule\"   WHERE \"fichiermodule\".\"modele\" = ''Dsp'' AND \"fichiermodule\".\"fk_value\" = \"Dsp\".\"id\"    ) ELSE ( SELECT COUNT(\"fichiermodule\".\"id\") FROM \"fichiersmodules\" AS \"fichiermodule\"   WHERE \"fichiermodule\".\"modele\" = ''Dsp'' AND \"fichiermodule\".\"fk_value\" = \"DspRev\".\"id\"    ) END ) AS \"Donnees__nb_fichiers_lies\"","Libderact66Metier.name":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN \"Libderact66Metier\".\"name\" ELSE \"Libderact66MetierRev\".\"name\" END ) AS \"Libderact66Metier__name\"","Libsecactrech66Secteur.name":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN \"Libsecactrech66Secteur\".\"name\" ELSE \"Libsecactrech66SecteurRev\".\"name\" END ) AS \"Libsecactrech66Secteur__name\"","Libemploirech66Metier.name":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN \"Libemploirech66Metier\".\"name\" ELSE \"Libemploirech66MetierRev\".\"name\" END ) AS \"Libemploirech66Metier__name\"","Deractromev3.appellationromev3":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN \"Deractromev3__Appellationromev3\".\"name\" ELSE \"Deractromev3Rev__Appellationromev3\".\"name\" END ) AS \"Deractromev3__appellationromev3__name\"","Actrechromev3.familleromev3":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN \"Actrechromev3__Familleromev3\".\"name\" ELSE \"Actrechromev3Rev__Familleromev3\".\"name\" END ) AS \"Actrechromev3__familleromev3__name\"","Actrechromev3.domaineromev3":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN \"Actrechromev3__Domaineromev3\".\"name\" ELSE \"Actrechromev3Rev__Domaineromev3\".\"name\" END ) AS \"Actrechromev3__domaineromev3__name\"","Actrechromev3.metierromev3":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN \"Actrechromev3__Metierromev3\".\"name\" ELSE \"Actrechromev3Rev__Metierromev3\".\"name\" END ) AS \"Actrechromev3__metierromev3__name\"","Actrechromev3.appellationromev3":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN \"Actrechromev3__Appellationromev3\".\"name\" ELSE \"Actrechromev3Rev__Appellationromev3\".\"name\" END ) AS \"Actrechromev3__appellationromev3__name\"","Donnees.difdisp":"( CASE WHEN \"Dsp\".\"id\" IS NOT NULL THEN TRIM( BOTH ''\n\r'' FROM TRIM( TRAILING '''' FROM ARRAY_TO_STRING( ARRAY( SELECT ''\\n\\r-'' || \"Detaildifdisp\".\"difdisp\" || '''' AS \"Detaildifdisp__difdisp\" FROM \"detailsdifdisps\" AS \"Detaildifdisp\"   WHERE \"Detaildifdisp\".\"dsp_id\" = \"Dsp\".\"id\"    ), '''' ) ) ) ELSE TRIM( BOTH ''\n\r'' FROM TRIM( TRAILING '''' FROM ARRAY_TO_STRING( ARRAY( SELECT ''\\n\\r-'' || \"DetaildifdispRev\".\"difdisp\" || '''' AS \"DetaildifdispRev__difdisp\" FROM \"detailsdifdisps_revs\" AS \"DetaildifdispRev\"   WHERE \"DetaildifdispRev\".\"dsp_rev_id\" = \"DspRev\".\"id\"    ), '''' ) ) ) END ) AS \"Donnees__difdisp\"","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:18:33'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"LEFT OUTER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"INNER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA'' AND \"Prestation\".\"rolepers\" IN (''DEM'', ''CJT'')"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"INNER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"dsps_revs","alias":"DspRev","type":"LEFT OUTER","foreignKey":false,"conditions":["DspRev.personne_id = Personne.id","DspRev.id IN ( SELECT \"tmp_dsps_revs\".\"id\" AS \"tmp_dsps_revs__id\" FROM \"dsps_revs\" AS \"tmp_dsps_revs\"   WHERE \"tmp_dsps_revs\".\"personne_id\" = \"Personne\".\"id\"   ORDER BY \"tmp_dsps_revs\".\"modified\" DESC  LIMIT 1 )"]},{"table":"dsps","alias":"Dsp","type":"LEFT OUTER","foreignKey":false,"conditions":["Dsp.personne_id = Personne.id","Dsp.personne_id NOT IN ( SELECT \"tmp_dsps_revs2\".\"personne_id\" AS \"tmp_dsps_revs2__personne_id\" FROM \"dsps_revs\" AS \"tmp_dsps_revs2\"   WHERE \"tmp_dsps_revs2\".\"personne_id\" = \"Dsp\".\"personne_id\"    )"]},{"table":"\"modescontact\"","alias":"Modecontact","type":"LEFT OUTER","conditions":"\"Modecontact\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Modecontact\".\"id\" IN ( SELECT \"modescontact\".\"id\" AS modescontact__id FROM modescontact AS modescontact   WHERE \"modescontact\".\"foyer_id\" = \"Foyer\".\"id\" AND \"modescontact\".\"autorutitel\" = ''A''   ORDER BY \"modescontact\".\"id\" DESC  LIMIT 1 )"},{"table":"\"memos\"","alias":"Memo","type":"LEFT OUTER","conditions":"\"Memo\".\"personne_id\" = \"Personne\".\"id\" AND \"Memo\".\"id\" IN ( SELECT \"memos\".\"id\" AS memos__id FROM memos AS memos   WHERE \"memos\".\"personne_id\" = \"Personne\".\"id\"   ORDER BY \"memos\".\"modified\" DESC  LIMIT 1 )"},{"table":"\"codesromesecteursdsps66\"","alias":"Libsecactderact66Secteur","type":"LEFT OUTER","conditions":"\"Dsp\".\"libsecactderact66_secteur_id\" = \"Libsecactderact66Secteur\".\"id\""},{"table":"\"codesromesecteursdsps66\"","alias":"Libsecactderact66SecteurRev","type":"LEFT OUTER","conditions":"\"DspRev\".\"libsecactderact66_secteur_id\" = \"Libsecactderact66SecteurRev\".\"id\""},{"table":"\"codesromemetiersdsps66\"","alias":"Libderact66Metier","type":"LEFT OUTER","conditions":"\"Dsp\".\"libderact66_metier_id\" = \"Libderact66Metier\".\"id\""},{"table":"\"codesromemetiersdsps66\"","alias":"Libderact66MetierRev","type":"LEFT OUTER","conditions":"\"DspRev\".\"libderact66_metier_id\" = \"Libderact66MetierRev\".\"id\""},{"table":"\"codesromesecteursdsps66\"","alias":"Libsecactdomi66Secteur","type":"LEFT OUTER","conditions":"\"Dsp\".\"libsecactdomi66_secteur_id\" = \"Libsecactdomi66Secteur\".\"id\""},{"table":"\"codesromesecteursdsps66\"","alias":"Libsecactdomi66SecteurRev","type":"LEFT OUTER","conditions":"\"DspRev\".\"libsecactdomi66_secteur_id\" = \"Libsecactdomi66SecteurRev\".\"id\""},{"table":"\"codesromemetiersdsps66\"","alias":"Libactdomi66Metier","type":"LEFT OUTER","conditions":"\"Dsp\".\"libactdomi66_metier_id\" = \"Libactdomi66Metier\".\"id\""},{"table":"\"codesromemetiersdsps66\"","alias":"Libactdomi66MetierRev","type":"LEFT OUTER","conditions":"\"DspRev\".\"libactdomi66_metier_id\" = \"Libactdomi66MetierRev\".\"id\""},{"table":"\"codesromesecteursdsps66\"","alias":"Libsecactrech66Secteur","type":"LEFT OUTER","conditions":"\"Dsp\".\"libsecactrech66_secteur_id\" = \"Libsecactrech66Secteur\".\"id\""},{"table":"\"codesromesecteursdsps66\"","alias":"Libsecactrech66SecteurRev","type":"LEFT OUTER","conditions":"\"DspRev\".\"libsecactrech66_secteur_id\" = \"Libsecactrech66SecteurRev\".\"id\""},{"table":"\"codesromemetiersdsps66\"","alias":"Libemploirech66Metier","type":"LEFT OUTER","conditions":"\"Dsp\".\"libemploirech66_metier_id\" = \"Libemploirech66Metier\".\"id\""},{"table":"\"codesromemetiersdsps66\"","alias":"Libemploirech66MetierRev","type":"LEFT OUTER","conditions":"\"DspRev\".\"libemploirech66_metier_id\" = \"Libemploirech66MetierRev\".\"id\""},{"table":"\"entreesromesv3\"","alias":"Deractromev3","type":"LEFT OUTER","conditions":"\"Dsp\".\"deractromev3_id\" = \"Deractromev3\".\"id\""},{"table":"\"entreesromesv3\"","alias":"Deractromev3Rev","type":"LEFT OUTER","conditions":"\"DspRev\".\"deractromev3_id\" = \"Deractromev3Rev\".\"id\""},{"table":"\"famillesromesv3\"","alias":"Deractromev3__Familleromev3","type":"LEFT OUTER","conditions":"\"Deractromev3\".\"familleromev3_id\" = \"Deractromev3__Familleromev3\".\"id\""},{"table":"\"famillesromesv3\"","alias":"Deractromev3Rev__Familleromev3","type":"LEFT OUTER","conditions":"\"Deractromev3Rev\".\"familleromev3_id\" = \"Deractromev3Rev__Familleromev3\".\"id\""},{"table":"\"domainesromesv3\"","alias":"Deractromev3__Domaineromev3","type":"LEFT OUTER","conditions":"\"Deractromev3\".\"domaineromev3_id\" = \"Deractromev3__Domaineromev3\".\"id\""},{"table":"\"domainesromesv3\"","alias":"Deractromev3Rev__Domaineromev3","type":"LEFT OUTER","conditions":"\"Deractromev3Rev\".\"domaineromev3_id\" = \"Deractromev3Rev__Domaineromev3\".\"id\""},{"table":"\"metiersromesv3\"","alias":"Deractromev3__Metierromev3","type":"LEFT OUTER","conditions":"\"Deractromev3\".\"metierromev3_id\" = \"Deractromev3__Metierromev3\".\"id\""},{"table":"\"metiersromesv3\"","alias":"Deractromev3Rev__Metierromev3","type":"LEFT OUTER","conditions":"\"Deractromev3Rev\".\"metierromev3_id\" = \"Deractromev3Rev__Metierromev3\".\"id\""},{"table":"\"appellationsromesv3\"","alias":"Deractromev3__Appellationromev3","type":"LEFT OUTER","conditions":"\"Deractromev3\".\"appellationromev3_id\" = \"Deractromev3__Appellationromev3\".\"id\""},{"table":"\"appellationsromesv3\"","alias":"Deractromev3Rev__Appellationromev3","type":"LEFT OUTER","conditions":"\"Deractromev3Rev\".\"appellationromev3_id\" = \"Deractromev3Rev__Appellationromev3\".\"id\""},{"table":"\"entreesromesv3\"","alias":"Deractdomiromev3","type":"LEFT OUTER","conditions":"\"Dsp\".\"deractdomiromev3_id\" = \"Deractdomiromev3\".\"id\""},{"table":"\"entreesromesv3\"","alias":"Deractdomiromev3Rev","type":"LEFT OUTER","conditions":"\"DspRev\".\"deractdomiromev3_id\" = \"Deractdomiromev3Rev\".\"id\""},{"table":"\"famillesromesv3\"","alias":"Deractdomiromev3__Familleromev3","type":"LEFT OUTER","conditions":"\"Deractdomiromev3\".\"familleromev3_id\" = \"Deractdomiromev3__Familleromev3\".\"id\""},{"table":"\"famillesromesv3\"","alias":"Deractdomiromev3Rev__Familleromev3","type":"LEFT OUTER","conditions":"\"Deractdomiromev3Rev\".\"familleromev3_id\" = \"Deractdomiromev3Rev__Familleromev3\".\"id\""},{"table":"\"domainesromesv3\"","alias":"Deractdomiromev3__Domaineromev3","type":"LEFT OUTER","conditions":"\"Deractdomiromev3\".\"domaineromev3_id\" = \"Deractdomiromev3__Domaineromev3\".\"id\""},{"table":"\"domainesromesv3\"","alias":"Deractdomiromev3Rev__Domaineromev3","type":"LEFT OUTER","conditions":"\"Deractdomiromev3Rev\".\"domaineromev3_id\" = \"Deractdomiromev3Rev__Domaineromev3\".\"id\""},{"table":"\"metiersromesv3\"","alias":"Deractdomiromev3__Metierromev3","type":"LEFT OUTER","conditions":"\"Deractdomiromev3\".\"metierromev3_id\" = \"Deractdomiromev3__Metierromev3\".\"id\""},{"table":"\"metiersromesv3\"","alias":"Deractdomiromev3Rev__Metierromev3","type":"LEFT OUTER","conditions":"\"Deractdomiromev3Rev\".\"metierromev3_id\" = \"Deractdomiromev3Rev__Metierromev3\".\"id\""},{"table":"\"appellationsromesv3\"","alias":"Deractdomiromev3__Appellationromev3","type":"LEFT OUTER","conditions":"\"Deractdomiromev3\".\"appellationromev3_id\" = \"Deractdomiromev3__Appellationromev3\".\"id\""},{"table":"\"appellationsromesv3\"","alias":"Deractdomiromev3Rev__Appellationromev3","type":"LEFT OUTER","conditions":"\"Deractdomiromev3Rev\".\"appellationromev3_id\" = \"Deractdomiromev3Rev__Appellationromev3\".\"id\""},{"table":"\"entreesromesv3\"","alias":"Actrechromev3","type":"LEFT OUTER","conditions":"\"Dsp\".\"actrechromev3_id\" = \"Actrechromev3\".\"id\""},{"table":"\"entreesromesv3\"","alias":"Actrechromev3Rev","type":"LEFT OUTER","conditions":"\"DspRev\".\"actrechromev3_id\" = \"Actrechromev3Rev\".\"id\""},{"table":"\"famillesromesv3\"","alias":"Actrechromev3__Familleromev3","type":"LEFT OUTER","conditions":"\"Actrechromev3\".\"familleromev3_id\" = \"Actrechromev3__Familleromev3\".\"id\""},{"table":"\"famillesromesv3\"","alias":"Actrechromev3Rev__Familleromev3","type":"LEFT OUTER","conditions":"\"Actrechromev3Rev\".\"familleromev3_id\" = \"Actrechromev3Rev__Familleromev3\".\"id\""},{"table":"\"domainesromesv3\"","alias":"Actrechromev3__Domaineromev3","type":"LEFT OUTER","conditions":"\"Actrechromev3\".\"domaineromev3_id\" = \"Actrechromev3__Domaineromev3\".\"id\""},{"table":"\"domainesromesv3\"","alias":"Actrechromev3Rev__Domaineromev3","type":"LEFT OUTER","conditions":"\"Actrechromev3Rev\".\"domaineromev3_id\" = \"Actrechromev3Rev__Domaineromev3\".\"id\""},{"table":"\"metiersromesv3\"","alias":"Actrechromev3__Metierromev3","type":"LEFT OUTER","conditions":"\"Actrechromev3\".\"metierromev3_id\" = \"Actrechromev3__Metierromev3\".\"id\""},{"table":"\"metiersromesv3\"","alias":"Actrechromev3Rev__Metierromev3","type":"LEFT OUTER","conditions":"\"Actrechromev3Rev\".\"metierromev3_id\" = \"Actrechromev3Rev__Metierromev3\".\"id\""},{"table":"\"appellationsromesv3\"","alias":"Actrechromev3__Appellationromev3","type":"LEFT OUTER","conditions":"\"Actrechromev3\".\"appellationromev3_id\" = \"Actrechromev3__Appellationromev3\".\"id\""},{"table":"\"appellationsromesv3\"","alias":"Actrechromev3Rev__Appellationromev3","type":"LEFT OUTER","conditions":"\"Actrechromev3Rev\".\"appellationromev3_id\" = \"Actrechromev3Rev__Appellationromev3\".\"id\""}],"limit":11,"offset":0,"order":[""],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par Rendez-vous', 1, 1, 'Rendezvous', '{"conditions":["Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)",[]],"fields":{"0":"Rendezvous.id","1":"Rendezvous.personne_id","Personne.dtnai":"Personne.dtnai","Personne.nir":"Personne.nir","( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"":"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"","Prestation.rolepers":"Prestation.rolepers","Adresse.numcom":"Adresse.numcom","Adresse.nomcom":"Adresse.nomcom","Canton.canton":"Canton.canton","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Structurereferenteparcours.lib_struc":"Structurereferenteparcours.lib_struc","Rendezvous.daterdv":"Rendezvous.daterdv","Rendezvous.heurerdv":"Rendezvous.heurerdv","( \"Referent\".\"qual\" || '' '' || \"Referent\".\"nom\" || '' '' || \"Referent\".\"prenom\" ) AS  \"Referent__nom_complet\"":"( \"Referent\".\"qual\" || '' '' || \"Referent\".\"nom\" || '' '' || \"Referent\".\"prenom\" ) AS  \"Referent__nom_complet\"","Statutrdv.libelle":"Statutrdv.libelle","Structurereferente.lib_struc":"Structurereferente.lib_struc","Typerdv.libelle":"Typerdv.libelle","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:19:37'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"personnes\"","alias":"Personne","type":"INNER","conditions":"\"Rendezvous\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"LEFT OUTER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"INNER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA'' AND \"Prestation\".\"rolepers\" IN (''DEM'', ''CJT'')"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"INNER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"referents\"","alias":"Referent","type":"LEFT OUTER","conditions":"\"Rendezvous\".\"referent_id\" = \"Referent\".\"id\""},{"table":"\"statutsrdvs\"","alias":"Statutrdv","type":"LEFT OUTER","conditions":"\"Rendezvous\".\"statutrdv_id\" = \"Statutrdv\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferente","type":"INNER","conditions":"\"Rendezvous\".\"structurereferente_id\" = \"Structurereferente\".\"id\""},{"table":"\"typesrdv\"","alias":"Typerdv","type":"LEFT OUTER","conditions":"\"Rendezvous\".\"typerdv_id\" = \"Typerdv\".\"id\""}],"limit":11,"offset":0,"order":[["Rendezvous.daterdv"]],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par Dossiers PCGs', 1, 1, 'Dossierpcg66', '{"conditions":{"OR":{"Prestation.rolepers":["DEM","CJT"],"0":"Prestation.id IS NULL"},"0":{"Prestation.rolepers":"DEM"},"1":"Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)","2":[]},"fields":{"Personne.nomcomnai":"Personne.nomcomnai","Personne.dtnai":"Personne.dtnai","Personne.nir":"Personne.nir","Adresse.numcom":"Adresse.numcom","Dossier.numdemrsa":"Dossier.numdemrsa","Dossier.matricule":"Dossier.matricule","Situationdossierrsa.etatdosrsa":"Situationdossierrsa.etatdosrsa","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Structurereferenteparcours.lib_struc":"Structurereferenteparcours.lib_struc","Dossierpcg66.datereceptionpdo":"Dossierpcg66.datereceptionpdo","Dossierpcg66.etatdossierpcg":"Dossierpcg66.etatdossierpcg","Dossierpcg66.nbpropositions":"Dossierpcg66.nbpropositions","( \"User\".\"nom\" || '' '' || \"User\".\"prenom\" ) AS  \"User__nom_complet\"":"( \"User\".\"nom\" || '' '' || \"User\".\"prenom\" ) AS  \"User__nom_complet\"","Poledossierpcg66.name":"Poledossierpcg66.name","Decisiondossierpcg66.datetransmissionop":"Decisiondossierpcg66.datetransmissionop","Originepdo.libelle":"Originepdo.libelle","Typepdo.libelle":"Typepdo.libelle","Traitementpcg66.datereception":"Traitementpcg66.datereception","Decisionpdo.libelle":"Decisionpdo.libelle","0":"Dossierpcg66.id","1":"Dossierpcg66.foyer_id","2":"Decisiondossierpcg66.id","Personnepcg66.noms_complet":"(''<ul>'' || ARRAY_TO_STRING(ARRAY(SELECT ''<li>'' || \"p\".\"nom\" || '' '' || \"p\".\"prenom\" || ''<\/li>'' AS \"Personnepcg66__noms_complet\" FROM \"dossierspcgs66\" AS \"pcg\" LEFT JOIN \"public\".\"personnespcgs66\" AS \"pers_pcg\" ON (\"pers_pcg\".\"dossierpcg66_id\" = \"pcg\".\"id\") LEFT JOIN \"public\".\"personnes\" AS \"p\" ON (\"pers_pcg\".\"personne_id\" = \"p\".\"id\") WHERE \"pcg\".\"id\" = \"Dossierpcg66\".\"id\" ), '''') || ''<\/ul>'') AS \"Personnepcg66__noms_complet\"","Decisiondossierpcg66.org_id":"(''<ul>'' || ARRAY_TO_STRING(ARRAY(SELECT ''<li>'' || \"Orgtransmisdossierpcg66\".\"name\" || ''<\/li>'' AS \"Orgtransmisdossierpcg66__name\" FROM \"decisionsdossierspcgs66\" AS \"Decisiondossierpcg66\" LEFT JOIN \"public\".\"decsdospcgs66_orgsdospcgs66\" AS \"Decdospcg66Orgdospcg66\" ON (\"Decdospcg66Orgdospcg66\".\"decisiondossierpcg66_id\" = \"Decisiondossierpcg66\".\"id\") LEFT JOIN \"public\".\"orgstransmisdossierspcgs66\" AS \"Orgtransmisdossierpcg66\" ON (\"Decdospcg66Orgdospcg66\".\"orgtransmisdossierpcg66_id\" = \"Orgtransmisdossierpcg66\".\"id\") WHERE \"Decisiondossierpcg66\".\"dossierpcg66_id\" = \"Dossierpcg66\".\"id\" ORDER BY \"Decisiondossierpcg66\".\"created\" DESC), '''') || ''<\/ul>'') AS \"Decisiondossierpcg66__org_id\"","Situationpdo.libelle":"(''<ul>'' || ARRAY_TO_STRING(ARRAY(SELECT ''<li>'' || \"Situationpdo\".\"libelle\" || ''<\/li>'' AS \"Situationpdo__libelle\" FROM \"personnespcgs66\" AS \"Personnepcg66\" LEFT OUTER JOIN \"public\".\"personnespcgs66_situationspdos\" AS \"Personnepcg66Situationpdo\" ON (\"Personnepcg66Situationpdo\".\"personnepcg66_id\" = \"Personnepcg66\".\"id\") LEFT OUTER JOIN \"public\".\"situationspdos\" AS \"Situationpdo\" ON (\"Personnepcg66Situationpdo\".\"situationpdo_id\" = \"Situationpdo\".\"id\") WHERE \"Personnepcg66\".\"dossierpcg66_id\" = \"Dossierpcg66\".\"id\"), '''') || ''<\/ul>'') AS \"Situationpdo__libelle\"","Traitementpcg66.statutpdo_id":"(''<ul>'' || ARRAY_TO_STRING(ARRAY(SELECT ''<li>'' || \"Statutpdo\".\"libelle\" || ''<\/li>'' AS \"Statutpdo__libelle\" FROM \"personnespcgs66\" AS \"Personnepcg66\" LEFT OUTER JOIN \"public\".\"personnespcgs66_statutspdos\" AS \"Personnepcg66Statutpdo\" ON (\"Personnepcg66Statutpdo\".\"personnepcg66_id\" = \"Personnepcg66\".\"id\") LEFT OUTER JOIN \"public\".\"statutspdos\" AS \"Statutpdo\" ON (\"Personnepcg66Statutpdo\".\"statutpdo_id\" = \"Statutpdo\".\"id\") WHERE \"Personnepcg66\".\"dossierpcg66_id\" = \"Dossierpcg66\".\"id\"), '''') || ''<\/ul>'') AS \"Traitementpcg66__statutpdo_id\"","Fichiermodule.nb_fichiers_lies":"(SELECT COUNT(\"fichiermodule\".\"id\") FROM \"fichiersmodules\" AS \"fichiermodule\" WHERE \"fichiermodule\".\"modele\" = ''Foyer'' AND \"fichiermodule\".\"fk_value\" = \"Foyer\".\"id\") AS \"Fichiermodule__nb_fichiers_lies\"","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:20:36'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Dossierpcg66\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"personnes\"","alias":"Personne","type":"LEFT OUTER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"LEFT OUTER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"LEFT OUTER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA''"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"INNER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"detailscalculsdroitsrsa\"","alias":"Detailcalculdroitrsa","type":"LEFT OUTER","conditions":"\"Detailcalculdroitrsa\".\"detaildroitrsa_id\" = \"Detaildroitrsa\".\"id\" AND \"Detailcalculdroitrsa\".\"id\" IN (SELECT \"detailscalculsdroitsrsa\".\"id\" AS detailscalculsdroitsrsa__id FROM detailscalculsdroitsrsa AS detailscalculsdroitsrsa WHERE \"detailscalculsdroitsrsa\".\"detaildroitrsa_id\" = \"Detaildroitrsa\".\"id\" ORDER BY \"detailscalculsdroitsrsa\".\"ddnatdro\" DESC LIMIT 1)"},{"table":"\"decisionsdossierspcgs66\"","alias":"Decisiondossierpcg66","type":"LEFT OUTER","conditions":"\"Decisiondossierpcg66\".\"dossierpcg66_id\" = \"Dossierpcg66\".\"id\" AND \"Decisiondossierpcg66\".\"validationproposition\" = ''O'' AND \"Decisiondossierpcg66\".\"id\" IN (SELECT \"decisionsdossierspcgs66\".\"id\" FROM decisionsdossierspcgs66 WHERE \"decisionsdossierspcgs66\".\"dossierpcg66_id\" = \"Dossierpcg66\".\"id\" ORDER BY \"decisionsdossierspcgs66\".\"created\" DESC LIMIT 1)"},{"table":"\"users\"","alias":"User","type":"LEFT OUTER","conditions":"\"Dossierpcg66\".\"user_id\" = \"User\".\"id\""},{"table":"\"polesdossierspcgs66\"","alias":"Poledossierpcg66","type":"LEFT OUTER","conditions":"\"Dossierpcg66\".\"poledossierpcg66_id\" = \"Poledossierpcg66\".\"id\""},{"table":"\"personnespcgs66\"","alias":"Personnepcg66","type":"LEFT OUTER","conditions":"\"Personnepcg66\".\"dossierpcg66_id\" = \"Dossierpcg66\".\"id\" AND \"Personnepcg66\".\"id\" IN (SELECT \"personnespcgs66\".\"id\" FROM personnespcgs66 WHERE \"personnespcgs66\".\"dossierpcg66_id\" = \"Dossierpcg66\".\"id\" ORDER BY \"personnespcgs66\".\"created\" LIMIT 1)"},{"table":"\"servicesinstructeurs\"","alias":"Serviceinstructeur","type":"LEFT OUTER","conditions":"\"Dossierpcg66\".\"serviceinstructeur_id\" = \"Serviceinstructeur\".\"id\""},{"table":"\"originespdos\"","alias":"Originepdo","type":"LEFT OUTER","conditions":"\"Dossierpcg66\".\"originepdo_id\" = \"Originepdo\".\"id\""},{"table":"\"typespdos\"","alias":"Typepdo","type":"LEFT OUTER","conditions":"\"Dossierpcg66\".\"typepdo_id\" = \"Typepdo\".\"id\""},{"table":"\"entreesromesv3\"","alias":"Categorieromev3","type":"LEFT OUTER","conditions":"\"Personnepcg66\".\"categorieromev3_id\" = \"Categorieromev3\".\"id\""},{"table":"\"famillesromesv3\"","alias":"Familleromev3","type":"LEFT OUTER","conditions":"\"Categorieromev3\".\"familleromev3_id\" = \"Familleromev3\".\"id\""},{"table":"\"domainesromesv3\"","alias":"Domaineromev3","type":"LEFT OUTER","conditions":"\"Categorieromev3\".\"domaineromev3_id\" = \"Domaineromev3\".\"id\""},{"table":"\"metiersromesv3\"","alias":"Metierromev3","type":"LEFT OUTER","conditions":"\"Categorieromev3\".\"metierromev3_id\" = \"Metierromev3\".\"id\""},{"table":"\"appellationsromesv3\"","alias":"Appellationromev3","type":"LEFT OUTER","conditions":"\"Categorieromev3\".\"appellationromev3_id\" = \"Appellationromev3\".\"id\""},{"table":"\"codesromemetiersdsps66\"","alias":"Categoriemetierromev2","type":"LEFT OUTER","conditions":"\"Personnepcg66\".\"categoriedetail\" = \"Categoriemetierromev2\".\"id\""},{"table":"\"traitementspcgs66\"","alias":"Traitementpcg66","type":"LEFT OUTER","conditions":["\"Traitementpcg66\".\"personnepcg66_id\" = \"Personnepcg66\".\"id\"","Traitementpcg66.id IN (SELECT \"traitement\".\"id\" AS \"traitement__id\" FROM \"traitementspcgs66\" AS \"traitement\"   WHERE \"traitement\".\"personnepcg66_id\" = \"Personnepcg66\".\"id\" AND \"traitement\".\"typetraitement\" = ''documentarrive'' AND \"traitement\".\"datereception\" IS NOT NULL AND \"Dossierpcg66\".\"etatdossierpcg\" = ''attinstrdocarrive''   ORDER BY \"traitement\".\"created\" DESC  LIMIT 1)"]},{"table":"\"decisionspdos\"","alias":"Decisionpdo","type":"LEFT OUTER","conditions":"\"Decisiondossierpcg66\".\"decisionpdo_id\" = \"Decisionpdo\".\"id\""}],"limit":11,"offset":0,"order":[""],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par Traitements PCGs', 1, 1, 'Traitementpcg66', '{"conditions":["Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)",[]],"fields":{"Personne.nomcomnai":"Personne.nomcomnai","Personne.dtnai":"Personne.dtnai","Personne.nir":"Personne.nir","( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"":"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"","Adresse.numcom":"Adresse.numcom","Dossier.numdemrsa":"Dossier.numdemrsa","Dossier.matricule":"Dossier.matricule","Situationdossierrsa.etatdosrsa":"Situationdossierrsa.etatdosrsa","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Structurereferenteparcours.lib_struc":"Structurereferenteparcours.lib_struc","Traitementpcg66.descriptionpdo_id":"Traitementpcg66.descriptionpdo_id","Traitementpcg66.datereception":"Traitementpcg66.datereception","Traitementpcg66.dateecheance":"Traitementpcg66.dateecheance","Traitementpcg66.clos":"Traitementpcg66.clos","Traitementpcg66.annule":"Traitementpcg66.annule","Traitementpcg66.created":"Traitementpcg66.created","Traitementpcg66.typetraitement":"Traitementpcg66.typetraitement","Dossierpcg66.datereceptionpdo":"Dossierpcg66.datereceptionpdo","Dossierpcg66.user_id":"Dossierpcg66.user_id","Situationpdo.libelle":"Situationpdo.libelle","0":"Personnepcg66.id","1":"Personnepcg66.personne_id","2":"Dossierpcg66.id","Fichiermodule.nb_fichiers_lies":"(SELECT COUNT(*) FROM \"fichiersmodules\" AS \"fichiermodule\" WHERE \"fichiermodule\".\"modele\" = ''Foyer'' AND \"fichiermodule\".\"fk_value\" = \"Foyer\".\"id\") AS \"Fichiermodule__nb_fichiers_lies\"","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:21:26'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"personnespcgs66\"","alias":"Personnepcg66","type":"INNER","conditions":"\"Traitementpcg66\".\"personnepcg66_id\" = \"Personnepcg66\".\"id\""},{"table":"\"personnes\"","alias":"Personne","type":"INNER","conditions":["Personne.id = Personnepcg66.personne_id"]},{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"LEFT OUTER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"INNER","conditions":{"0":"Personne.id = Prestation.personne_id","Prestation.natprest":"RSA"}},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"INNER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"dossierspcgs66\"","alias":"Dossierpcg66","type":"INNER","conditions":"\"Personnepcg66\".\"dossierpcg66_id\" = \"Dossierpcg66\".\"id\""},{"table":"\"situationspdos\"","alias":"Situationpdo","type":"LEFT OUTER","conditions":"\"Traitementpcg66\".\"situationpdo_id\" = \"Situationpdo\".\"id\""},{"table":"\"detailscalculsdroitsrsa\"","alias":"Detailcalculdroitrsa","type":"LEFT OUTER","conditions":"\"Detailcalculdroitrsa\".\"detaildroitrsa_id\" = \"Detaildroitrsa\".\"id\" AND \"Detailcalculdroitrsa\".\"id\" IN (SELECT \"d\".\"id\" FROM detailscalculsdroitsrsa AS d WHERE \"d\".\"detaildroitrsa_id\" = \"Detaildroitrsa\".\"id\" ORDER BY \"d\".\"ddnatdro\" DESC LIMIT 1)"},{"table":"\"users\"","alias":"User","type":"LEFT OUTER","conditions":"\"Dossierpcg66\".\"user_id\" = \"User\".\"id\""},{"table":"\"descriptionspdos\"","alias":"Descriptionpdo","type":"LEFT OUTER","conditions":"\"Traitementpcg66\".\"descriptionpdo_id\" = \"Descriptionpdo\".\"id\""}],"limit":11,"offset":0,"order":[""],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par Gestionnaire de dossiers PCG', 1, 1, 'Dossierpcg66', '{"conditions":{"OR":{"Prestation.rolepers":["DEM","CJT"],"0":"Prestation.id IS NULL"},"0":{"Prestation.rolepers":"DEM"},"1":"Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)","Dossierpcg66.etatdossierpcg":["decisionnonvalid","decisionvalid","attinstr"],"2":[]},"fields":{"Personne.nomcomnai":"Personne.nomcomnai","Personne.dtnai":"Personne.dtnai","Personne.nir":"Personne.nir","Adresse.numcom":"Adresse.numcom","Dossier.numdemrsa":"Dossier.numdemrsa","Dossier.matricule":"Dossier.matricule","Situationdossierrsa.etatdosrsa":"Situationdossierrsa.etatdosrsa","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Structurereferenteparcours.lib_struc":"Structurereferenteparcours.lib_struc","Dossierpcg66.typepdo_id":"Dossierpcg66.typepdo_id","Dossierpcg66.etatdossierpcg":"Dossierpcg66.etatdossierpcg","Dossierpcg66.originepdo_id":"Dossierpcg66.originepdo_id","Dossierpcg66.user_id":"Dossierpcg66.user_id","Dossierpcg66.nbpropositions":"Dossierpcg66.nbpropositions","Decisiondossierpcg66.decisionpdo_id":"Decisiondossierpcg66.decisionpdo_id","Traitementpcg66.dateecheance":"Traitementpcg66.dateecheance","0":"Dossierpcg66.id","1":"Dossierpcg66.foyer_id","2":"Decisiondossierpcg66.id","Personnepcg66.noms_complet":"(''<ul>'' || ARRAY_TO_STRING(ARRAY(SELECT ''<li>'' || \"p\".\"nom\" || '' '' || \"p\".\"prenom\" || ''<\/li>'' AS \"Personnepcg66__noms_complet\" FROM \"dossierspcgs66\" AS \"pcg\" LEFT JOIN \"public\".\"personnespcgs66\" AS \"pers_pcg\" ON (\"pers_pcg\".\"dossierpcg66_id\" = \"pcg\".\"id\") LEFT JOIN \"public\".\"personnes\" AS \"p\" ON (\"pers_pcg\".\"personne_id\" = \"p\".\"id\") WHERE \"pcg\".\"id\" = \"Dossierpcg66\".\"id\" ), '''') || ''<\/ul>'') AS \"Personnepcg66__noms_complet\"","Situationpdo.libelle":"(''<ul>'' || ARRAY_TO_STRING(ARRAY(SELECT ''<li>'' || \"Situationpdo\".\"libelle\" || ''<\/li>'' AS \"Situationpdo__libelle\" FROM \"personnespcgs66\" AS \"Personnepcg66\" LEFT OUTER JOIN \"public\".\"personnespcgs66_situationspdos\" AS \"Personnepcg66Situationpdo\" ON (\"Personnepcg66Situationpdo\".\"personnepcg66_id\" = \"Personnepcg66\".\"id\") LEFT OUTER JOIN \"public\".\"situationspdos\" AS \"Situationpdo\" ON (\"Personnepcg66Situationpdo\".\"situationpdo_id\" = \"Situationpdo\".\"id\") WHERE \"Personnepcg66\".\"dossierpcg66_id\" = \"Dossierpcg66\".\"id\"), '''') || ''<\/ul>'') AS \"Situationpdo__libelle\"","Traitementpcg66.statutpdo_id":"(''<ul>'' || ARRAY_TO_STRING(ARRAY(SELECT ''<li>'' || \"Statutpdo\".\"libelle\" || ''<\/li>'' AS \"Statutpdo__libelle\" FROM \"personnespcgs66\" AS \"Personnepcg66\" LEFT OUTER JOIN \"public\".\"personnespcgs66_statutspdos\" AS \"Personnepcg66Statutpdo\" ON (\"Personnepcg66Statutpdo\".\"personnepcg66_id\" = \"Personnepcg66\".\"id\") LEFT OUTER JOIN \"public\".\"statutspdos\" AS \"Statutpdo\" ON (\"Personnepcg66Statutpdo\".\"statutpdo_id\" = \"Statutpdo\".\"id\") WHERE \"Personnepcg66\".\"dossierpcg66_id\" = \"Dossierpcg66\".\"id\"), '''') || ''<\/ul>'') AS \"Traitementpcg66__statutpdo_id\"","Dossierpcg66.listetraitements":"(''<ul>'' || ARRAY_TO_STRING(ARRAY(SELECT ''<li>'' || \"Traitementpcg66\".\"typetraitement\" || ''<\/li>'' AS \"Traitementpcg66__typetraitement\" FROM \"traitementspcgs66\" AS \"Traitementpcg66\" INNER JOIN \"public\".\"personnespcgs66\" AS \"Personnepcg66\" ON (\"Traitementpcg66\".\"personnepcg66_id\" = \"Personnepcg66\".\"id\") WHERE \"Personnepcg66\".\"dossierpcg66_id\" = \"Dossierpcg66\".\"id\"), '''') || ''<\/ul>'') AS \"Dossierpcg66__listetraitements\"","Fichiermodule.nb_fichiers_lies":"(SELECT COUNT(\"fichiermodule\".\"id\") FROM \"fichiersmodules\" AS \"fichiermodule\" WHERE \"fichiermodule\".\"modele\" = ''Foyer'' AND \"fichiermodule\".\"fk_value\" = \"Foyer\".\"id\") AS \"Fichiermodule__nb_fichiers_lies\"","(\n\t\t\t\t\tSELECT COUNT(*)\n\t\t\t\t\t\tFROM traitementspcgs66\n\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\ttraitementspcgs66.personnepcg66_id = \"Personnepcg66\".\"id\"\n\t\t\t\t) AS  \"Personnepcg66__nbtraitements\"":"(SELECT COUNT(*) FROM traitementspcgs66 WHERE traitementspcgs66.personnepcg66_id = \"Personnepcg66\".\"id\") AS \"Personnepcg66__nbtraitements\"","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:22:04'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Dossierpcg66\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"personnes\"","alias":"Personne","type":"LEFT OUTER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"LEFT OUTER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"LEFT OUTER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA''"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"INNER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"detailscalculsdroitsrsa\"","alias":"Detailcalculdroitrsa","type":"LEFT OUTER","conditions":"\"Detailcalculdroitrsa\".\"detaildroitrsa_id\" = \"Detaildroitrsa\".\"id\" AND \"Detailcalculdroitrsa\".\"id\" IN (SELECT \"detailscalculsdroitsrsa\".\"id\" AS detailscalculsdroitsrsa__id FROM detailscalculsdroitsrsa AS detailscalculsdroitsrsa WHERE \"detailscalculsdroitsrsa\".\"detaildroitrsa_id\" = \"Detaildroitrsa\".\"id\" ORDER BY \"detailscalculsdroitsrsa\".\"ddnatdro\" DESC LIMIT 1)"},{"table":"\"decisionsdossierspcgs66\"","alias":"Decisiondossierpcg66","type":"LEFT OUTER","conditions":"\"Decisiondossierpcg66\".\"dossierpcg66_id\" = \"Dossierpcg66\".\"id\" AND \"Decisiondossierpcg66\".\"validationproposition\" = ''O'' AND \"Decisiondossierpcg66\".\"id\" IN (SELECT \"decisionsdossierspcgs66\".\"id\" FROM decisionsdossierspcgs66 WHERE \"decisionsdossierspcgs66\".\"dossierpcg66_id\" = \"Dossierpcg66\".\"id\" ORDER BY \"decisionsdossierspcgs66\".\"created\" DESC LIMIT 1)"},{"table":"\"users\"","alias":"User","type":"LEFT OUTER","conditions":"\"Dossierpcg66\".\"user_id\" = \"User\".\"id\""},{"table":"\"polesdossierspcgs66\"","alias":"Poledossierpcg66","type":"LEFT OUTER","conditions":"\"Dossierpcg66\".\"poledossierpcg66_id\" = \"Poledossierpcg66\".\"id\""},{"table":"\"personnespcgs66\"","alias":"Personnepcg66","type":"LEFT OUTER","conditions":"\"Personnepcg66\".\"dossierpcg66_id\" = \"Dossierpcg66\".\"id\" AND \"Personnepcg66\".\"id\" IN (SELECT \"personnespcgs66\".\"id\" FROM personnespcgs66 WHERE \"personnespcgs66\".\"dossierpcg66_id\" = \"Dossierpcg66\".\"id\" ORDER BY \"personnespcgs66\".\"created\" LIMIT 1)"},{"table":"\"servicesinstructeurs\"","alias":"Serviceinstructeur","type":"LEFT OUTER","conditions":"\"Dossierpcg66\".\"serviceinstructeur_id\" = \"Serviceinstructeur\".\"id\""},{"table":"\"originespdos\"","alias":"Originepdo","type":"LEFT OUTER","conditions":"\"Dossierpcg66\".\"originepdo_id\" = \"Originepdo\".\"id\""},{"table":"\"typespdos\"","alias":"Typepdo","type":"LEFT OUTER","conditions":"\"Dossierpcg66\".\"typepdo_id\" = \"Typepdo\".\"id\""},{"table":"\"entreesromesv3\"","alias":"Categorieromev3","type":"LEFT OUTER","conditions":"\"Personnepcg66\".\"categorieromev3_id\" = \"Categorieromev3\".\"id\""},{"table":"\"famillesromesv3\"","alias":"Familleromev3","type":"LEFT OUTER","conditions":"\"Categorieromev3\".\"familleromev3_id\" = \"Familleromev3\".\"id\""},{"table":"\"domainesromesv3\"","alias":"Domaineromev3","type":"LEFT OUTER","conditions":"\"Categorieromev3\".\"domaineromev3_id\" = \"Domaineromev3\".\"id\""},{"table":"\"metiersromesv3\"","alias":"Metierromev3","type":"LEFT OUTER","conditions":"\"Categorieromev3\".\"metierromev3_id\" = \"Metierromev3\".\"id\""},{"table":"\"appellationsromesv3\"","alias":"Appellationromev3","type":"LEFT OUTER","conditions":"\"Categorieromev3\".\"appellationromev3_id\" = \"Appellationromev3\".\"id\""},{"table":"\"codesromemetiersdsps66\"","alias":"Categoriemetierromev2","type":"LEFT OUTER","conditions":"\"Personnepcg66\".\"categoriedetail\" = \"Categoriemetierromev2\".\"id\""},{"table":"\"traitementspcgs66\"","alias":"Traitementpcg66","type":"LEFT OUTER","conditions":["\"Traitementpcg66\".\"personnepcg66_id\" = \"Personnepcg66\".\"id\"","Traitementpcg66.id IN (SELECT \"traitement\".\"id\" AS \"traitement__id\" FROM \"traitementspcgs66\" AS \"traitement\"   WHERE \"traitement\".\"personnepcg66_id\" = \"Personnepcg66\".\"id\" AND \"traitement\".\"typetraitement\" = ''documentarrive'' AND \"traitement\".\"datereception\" IS NOT NULL AND \"Dossierpcg66\".\"etatdossierpcg\" = ''attinstrdocarrive''   ORDER BY \"traitement\".\"created\" DESC  LIMIT 1)"]},{"table":"\"decisionspdos\"","alias":"Decisionpdo","type":"LEFT OUTER","conditions":"\"Decisiondossierpcg66\".\"decisionpdo_id\" = \"Decisionpdo\".\"id\""}],"limit":11,"offset":0,"order":[""],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par Bilans de parcours', 1, 1, 'Bilanparcours66', '{"conditions":{"OR":{"Prestation.rolepers":["DEM","CJT"],"0":"Prestation.id IS NULL"},"0":"Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)","1":[]},"fields":{"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"":"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"","Adresse.numcom":"Adresse.numcom","Adresse.nomcom":"Adresse.nomcom","Dossier.numdemrsa":"Dossier.numdemrsa","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Structurereferenteparcours.lib_struc":"Structurereferenteparcours.lib_struc","Bilanparcours66.choixparcours":"Bilanparcours66.choixparcours","Bilanparcours66.examenaudition":"Bilanparcours66.examenaudition","Bilanparcours66.datebilan":"Bilanparcours66.datebilan","Bilanparcours66.proposition":"Bilanparcours66.proposition","Bilanparcours66.positionbilan":"Bilanparcours66.positionbilan","Bilanparcours66.examenauditionpe":"Bilanparcours66.examenauditionpe","( \"Referent\".\"qual\" || '' '' || \"Referent\".\"nom\" || '' '' || \"Referent\".\"prenom\" ) AS  \"Referent__nom_complet\"":"( \"Referent\".\"qual\" || '' '' || \"Referent\".\"nom\" || '' '' || \"Referent\".\"prenom\" ) AS  \"Referent__nom_complet\"","Dossierep.themeep":"Dossierep.themeep","Structurereferente.lib_struc":"Structurereferente.lib_struc","0":"Bilanparcours66.id","1":"Bilanparcours66.personne_id","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:22:51'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"personnes\"","alias":"Personne","type":"INNER","conditions":"\"Bilanparcours66\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"LEFT OUTER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"LEFT OUTER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA''"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"INNER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"INNER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"INNER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferente","type":"INNER","conditions":"\"Bilanparcours66\".\"structurereferente_id\" = \"Structurereferente\".\"id\""},{"table":"\"referents\"","alias":"Referent","type":"INNER","conditions":"\"Bilanparcours66\".\"referent_id\" = \"Referent\".\"id\""},{"table":"\"typesorients\"","alias":"Typeorient","type":"LEFT OUTER","conditions":"\"Structurereferente\".\"typeorient_id\" = \"Typeorient\".\"id\""},{"table":"\"orientsstructs\"","alias":"Orientstruct","type":"LEFT OUTER","conditions":"\"Bilanparcours66\".\"orientstruct_id\" = \"Orientstruct\".\"id\""},{"table":"\"defautsinsertionseps66\"","alias":"Defautinsertionep66","type":"LEFT OUTER","conditions":"\"Defautinsertionep66\".\"bilanparcours66_id\" = \"Bilanparcours66\".\"id\""},{"table":"\"saisinesbilansparcourseps66\"","alias":"Saisinebilanparcoursep66","type":"LEFT OUTER","conditions":"\"Saisinebilanparcoursep66\".\"bilanparcours66_id\" = \"Bilanparcours66\".\"id\""},{"table":"\"dossierseps\"","alias":"Dossierep","type":"LEFT OUTER","conditions":"(\"Defautinsertionep66\".\"dossierep_id\" = \"Dossierep\".\"id\") OR (\"Saisinebilanparcoursep66\".\"dossierep_id\" = \"Dossierep\".\"id\")"}],"limit":11,"offset":0,"order":[["Bilanparcours66.datebilan"]],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par Allocataires non inscrits à Pôle Emploi', 1, 1, 'Personne', '{"conditions":["NOT EXISTS(\n\t\t\t\t\tSELECT \"a\".id\n\t\t\t\t\tFROM dossierseps AS \"a\"\n\t\t\t\t\tLEFT JOIN passagescommissionseps AS \"b\" ON \"a\".id = \"b\".dossierep_id\n\t\t\t\t\tLEFT JOIN commissionseps AS \"c\" ON \"c\".id = \"b\".commissionep_id\n\t\t\t\t\tWHERE \"a\".personne_id = \"Personne\".id \n\t\t\t\t\tAND \"a\".themeep = ''defautsinsertionseps66'' \n\t\t\t\t\tAND \"a\".actif = ''1''\n\t\t\t\t\tAND\n\t\t\t\t\t(\n\t\t\t\t\t\t\"b\".id IS NULL\n\t\t\t\t\t\tOR\n\t\t\t\t\t\t\"b\".etatdossierep IN (''associe'', ''decisionep'', ''decisioncg'', ''reporte'')\n\t\t\t\t\t\tOR\n\t\t\t\t\t\t\"c\".dateseance >= ''2016-02-22''\n\t\t\t\t\t)\n\t\t\t\t)","Orientstruct.date_valid + INTERVAL ''6 weeks'' < DATE_TRUNC( ''day'', NOW() )","Personne.id NOT IN (\n\t\t\t\tSELECT\n\t\t\t\t\t\tpersonnes.id\n\t\t\t\t\tFROM informationspe\n\t\t\t\t\t\tINNER JOIN historiqueetatspe ON (\n\t\t\t\t\t\t\tinformationspe.id = historiqueetatspe.informationpe_id\n\t\t\t\t\t\t\tAND historiqueetatspe.id IN (\n\t\t\t\t\t\t\t\t\t\tSELECT h.id\n\t\t\t\t\t\t\t\t\t\t\tFROM historiqueetatspe AS h\n\t\t\t\t\t\t\t\t\t\t\tWHERE h.informationpe_id = informationspe.id\n\t\t\t\t\t\t\t\t\t\t\tORDER BY h.date DESC, h.id DESC\n\t\t\t\t\t\t\t\t\t\t\tLIMIT 1\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t\tINNER JOIN personnes ON (\n\t\t\t\t\t\t\t((((\"informationspe\".\"nir\" IS NOT NULL)  AND  (SUBSTRING( \"informationspe\".\"nir\" FROM 1 FOR 13 ) = SUBSTRING( TRIM( BOTH '' '' FROM \"personnes\".\"nir\" ) FROM 1 FOR 13 ))  AND  (\"informationspe\".\"dtnai\" = \"personnes\".\"dtnai\"))) OR (((\"personnes\".\"nom\" IS NOT NULL)  AND  (\"personnes\".\"prenom\" IS NOT NULL)  AND  (\"personnes\".\"dtnai\" IS NOT NULL)  AND  (TRIM( BOTH '' '' FROM \"personnes\".\"nom\" ) <> '''')  AND  (TRIM( BOTH '' '' FROM \"personnes\".\"prenom\" ) <> '''')  AND  (TRIM( BOTH '' '' FROM \"informationspe\".\"nom\" ) = TRIM( BOTH '' '' FROM \"personnes\".\"nom\" ))  AND  (TRIM( BOTH '' '' FROM \"informationspe\".\"prenom\" ) = TRIM( BOTH '' '' FROM \"personnes\".\"prenom\" ))  AND  (\"informationspe\".\"dtnai\" = \"personnes\".\"dtnai\"))))\n\t\t\t\t\t\t)\n\t\t\t\t\tWHERE\n\t\t\t\t\t\tpersonnes.id = Personne.id\n\t\t\t\t\t\tAND historiqueetatspe.etat = ''inscription''\n\t\t\t\t\t\tAND historiqueetatspe.date >= Orientstruct.date_valid\n\t\t\t)","Calculdroitrsa.toppersdrodevorsa = ''1''","( Situationdossierrsa.etatdosrsa IN ( ''Z'', ''2'', ''3'', ''4'' ) )","Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)",[]],"fields":{"Personne.nom":"Personne.nom","Personne.prenom":"Personne.prenom","Personne.dtnai":"Personne.dtnai","(\n\t\t\t\t\tCASE WHEN NOT\n\t\t\t\t\t(\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''DEM''\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t) = 1\n\t\t\t\t\t\tAND\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''CJT''\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t) <= 1\n\t\t\t\t\t) THEN (\n\t\t\t\t\t\t''Ce foyer comporte '' ||\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''DEM''\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t|| '' demandeur(s) et '' ||\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''CJT''\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) || '' conjoint(s).''\n\t\t\t\t\t) ELSE NULL\n\t\t\t\t\tEND\n\t\t\t\t) AS  \"Foyer__enerreur\"":"(\n\t\t\t\t\tCASE WHEN NOT\n\t\t\t\t\t(\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''DEM''\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t) = 1\n\t\t\t\t\t\tAND\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''CJT''\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t) <= 1\n\t\t\t\t\t) THEN (\n\t\t\t\t\t\t''Ce foyer comporte '' ||\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''DEM''\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t|| '' demandeur(s) et '' ||\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''CJT''\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) || '' conjoint(s).''\n\t\t\t\t\t) ELSE NULL\n\t\t\t\t\tEND\n\t\t\t\t) AS  \"Foyer__enerreur\"","Situationdossierrsa.etatdosrsa":"Situationdossierrsa.etatdosrsa","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Structurereferenteparcours.lib_struc":"Structurereferenteparcours.lib_struc","Orientstruct.date_valid":"Orientstruct.date_valid","0":"Personne.id","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:23:22'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"INNER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"INNER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA'' AND \"Prestation\".\"rolepers\" IN (''DEM'', ''CJT'')"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"INNER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"INNER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"INNER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"orientsstructs\"","alias":"Orientstruct","type":"INNER","conditions":"\"Orientstruct\".\"personne_id\" = \"Personne\".\"id\" AND \"Orientstruct\".\"id\" IN (SELECT \"o\".\"id\"\n\t\t\t\t\t\t\t\t\t\t\tFROM orientsstructs AS o\n\t\t\t\t\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\t\t\t\t\t\"o\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\t\t\t\t\t\t\tAND \"o\".\"date_valid\" IS NOT NULL\n\t\t\t\t\t\t\t\t\t\t\tORDER BY \"o\".\"date_valid\" DESC\n\t\t\t\t\t\t\t\t\t\t\tLIMIT 1) AND \"Orientstruct\".\"typeorient_id\" IN (SELECT \"t\".\"id\"\n\t\t\t\t\t\t\t\t\tFROM typesorients AS t\n\t\t\t\t\t\t\t\t\tWHERE \"t\".\"lib_type_orient\" LIKE ''Emploi %'')"}],"limit":11,"offset":0,"order":[["Orientstruct.date_valid"]],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par Allocataires radiés de Pôle Emploi', 1, 1, 'Personne', '{"conditions":["NOT EXISTS(\n\t\t\t\t\tSELECT \"a\".id\n\t\t\t\t\tFROM dossierseps AS \"a\"\n\t\t\t\t\tLEFT JOIN passagescommissionseps AS \"b\" ON \"a\".id = \"b\".dossierep_id\n\t\t\t\t\tLEFT JOIN commissionseps AS \"c\" ON \"c\".id = \"b\".commissionep_id\n\t\t\t\t\tWHERE \"a\".personne_id = \"Personne\".id \n\t\t\t\t\tAND \"a\".themeep = ''defautsinsertionseps66'' \n\t\t\t\t\tAND \"a\".actif = ''1''\n\t\t\t\t\tAND\n\t\t\t\t\t(\n\t\t\t\t\t\t\"b\".id IS NULL\n\t\t\t\t\t\tOR\n\t\t\t\t\t\t\"b\".etatdossierep IN (''associe'', ''decisionep'', ''decisioncg'', ''reporte'')\n\t\t\t\t\t\tOR\n\t\t\t\t\t\t\"c\".dateseance >= ''2016-02-22''\n\t\t\t\t\t)\n\t\t\t\t)","Calculdroitrsa.toppersdrodevorsa = ''1''","( Situationdossierrsa.etatdosrsa IN ( ''Z'', ''2'', ''3'', ''4'' ) )","Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)",{"Historiqueetatpe.etat":"radiation","0":"Informationpe.id IN ( SELECT \"derniereinformationspe\".\"i__id\" FROM ( SELECT \"i\".\"id\" AS \"i__id\", \"h\".\"date\" AS \"h__date\" FROM \"informationspe\" AS \"i\" INNER JOIN \"public\".\"historiqueetatspe\" AS \"h\" ON (\"h\".\"informationpe_id\" = \"i\".\"id\")  WHERE ((((\"i\".\"nir\" IS NOT NULL)  AND  (\"Personne\".\"nir\" IS NOT NULL)  AND  (TRIM( BOTH '' '' FROM \"i\".\"nir\" ) <> '''')  AND  (TRIM( BOTH '' '' FROM \"Personne\".\"nir\" ) <> '''')  AND  (SUBSTRING( \"i\".\"nir\" FROM 1 FOR 13 ) = SUBSTRING( \"Personne\".\"nir\" FROM 1 FOR 13 ))  AND  (\"i\".\"dtnai\" = \"Personne\".\"dtnai\"))) OR (((\"i\".\"nom\" IS NOT NULL)  AND  (\"Personne\".\"nom\" IS NOT NULL)  AND  (\"i\".\"prenom\" IS NOT NULL)  AND  (\"Personne\".\"prenom\" IS NOT NULL)  AND  (TRIM( BOTH '' '' FROM \"i\".\"nom\" ) <> '''')  AND  (TRIM( BOTH '' '' FROM \"i\".\"prenom\" ) <> '''')  AND  (TRIM( BOTH '' '' FROM \"Personne\".\"nom\" ) <> '''')  AND  (TRIM( BOTH '' '' FROM \"Personne\".\"prenom\" ) <> '''')  AND  (TRIM( BOTH '' '' FROM \"i\".\"nom\" ) = \"Personne\".\"nom\")  AND  (TRIM( BOTH '' '' FROM \"i\".\"prenom\" ) = \"Personne\".\"prenom\")  AND  (\"i\".\"dtnai\" = \"Personne\".\"dtnai\")))) AND \"h\".\"id\" IN ( SELECT \"dernierhistoriqueetatspe\".\"id\" AS dernierhistoriqueetatspe__id FROM historiqueetatspe AS dernierhistoriqueetatspe   WHERE \"dernierhistoriqueetatspe\".\"informationpe_id\" = \"i\".\"id\"   ORDER BY \"dernierhistoriqueetatspe\".\"date\" DESC, \"dernierhistoriqueetatspe\".\"id\" DESC  LIMIT 1 )    ) AS \"derniereinformationspe\" ORDER BY \"derniereinformationspe\".\"h__date\" DESC LIMIT 1 )"},[]],"fields":{"Personne.nom":"Personne.nom","Personne.prenom":"Personne.prenom","Personne.dtnai":"Personne.dtnai","(\n\t\t\t\t\tCASE WHEN NOT\n\t\t\t\t\t(\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''DEM''\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t) = 1\n\t\t\t\t\t\tAND\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''CJT''\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t) <= 1\n\t\t\t\t\t) THEN (\n\t\t\t\t\t\t''Ce foyer comporte '' ||\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''DEM''\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t|| '' demandeur(s) et '' ||\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''CJT''\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) || '' conjoint(s).''\n\t\t\t\t\t) ELSE NULL\n\t\t\t\t\tEND\n\t\t\t\t) AS  \"Foyer__enerreur\"":"(\n\t\t\t\t\tCASE WHEN NOT\n\t\t\t\t\t(\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''DEM''\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t) = 1\n\t\t\t\t\t\tAND\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''CJT''\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t) <= 1\n\t\t\t\t\t) THEN (\n\t\t\t\t\t\t''Ce foyer comporte '' ||\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''DEM''\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t|| '' demandeur(s) et '' ||\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''CJT''\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) || '' conjoint(s).''\n\t\t\t\t\t) ELSE NULL\n\t\t\t\t\tEND\n\t\t\t\t) AS  \"Foyer__enerreur\"","Situationdossierrsa.etatdosrsa":"Situationdossierrsa.etatdosrsa","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Structurereferenteparcours.lib_struc":"Structurereferenteparcours.lib_struc","Orientstruct.date_valid":"Orientstruct.date_valid","0":"Personne.id","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:24:23'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"INNER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"INNER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA'' AND \"Prestation\".\"rolepers\" IN (''DEM'', ''CJT'')"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"INNER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"INNER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"INNER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"orientsstructs\"","alias":"Orientstruct","type":"INNER","conditions":"\"Orientstruct\".\"personne_id\" = \"Personne\".\"id\" AND \"Orientstruct\".\"id\" IN (SELECT \"o\".\"id\"\n\t\t\t\t\t\t\t\t\t\t\tFROM orientsstructs AS o\n\t\t\t\t\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\t\t\t\t\t\"o\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\t\t\t\t\t\t\tAND \"o\".\"date_valid\" IS NOT NULL\n\t\t\t\t\t\t\t\t\t\t\tORDER BY \"o\".\"date_valid\" DESC\n\t\t\t\t\t\t\t\t\t\t\tLIMIT 1) AND \"Orientstruct\".\"typeorient_id\" IN (SELECT \"t\".\"id\"\n\t\t\t\t\t\t\t\t\tFROM typesorients AS t\n\t\t\t\t\t\t\t\t\tWHERE \"t\".\"lib_type_orient\" LIKE ''Emploi %'')"},{"table":"informationspe","alias":"Informationpe","type":"INNER","foreignKey":false,"conditions":{"OR":[["Informationpe.nir IS NOT NULL","SUBSTRING( Informationpe.nir FROM 1 FOR 13 ) = SUBSTRING( TRIM( BOTH '' '' FROM Personne.nir ) FROM 1 FOR 13 )","Informationpe.dtnai = Personne.dtnai"],{"0":"Personne.nom IS NOT NULL","1":"Personne.prenom IS NOT NULL","2":"Personne.dtnai IS NOT NULL","TRIM( BOTH '' '' FROM Personne.nom ) <>":"","TRIM( BOTH '' '' FROM Personne.prenom ) <>":"","3":"TRIM( BOTH '' '' FROM Informationpe.nom ) = TRIM( BOTH '' '' FROM Personne.nom )","4":"TRIM( BOTH '' '' FROM Informationpe.prenom ) = TRIM( BOTH '' '' FROM Personne.prenom )","5":"Informationpe.dtnai = Personne.dtnai"}]}},{"table":"historiqueetatspe","alias":"Historiqueetatpe","type":"INNER","foreignKey":false,"conditions":["Historiqueetatpe.informationpe_id = Informationpe.id","Historiqueetatpe.id IN (\n\t\t\t\t\t\t\t\tSELECT h.id\n\t\t\t\t\t\t\t\t\tFROM historiqueetatspe AS h\n\t\t\t\t\t\t\t\t\tWHERE h.informationpe_id = Informationpe.id\n\t\t\t\t\t\t\t\t\tORDER BY h.date DESC, h.id DESC\n\t\t\t\t\t\t\t\t\tLIMIT 1\n\t\t\t\t\t)"]}],"limit":11,"offset":0,"order":[["Historiqueetatpe.date","Historiqueetatpe.id"]],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par Demande de maintien dans le social', 1, 1, 'Orientstruct', '{"conditions":["Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)",["EXISTS(\n\t\t\t\tSELECT\n\t\t\t\t\t*\n\t\t\t\tFROM orientsstructs\n\t\t\t\t\tINNER JOIN typesorients ON ( typesorients.id = orientsstructs.typeorient_id )\n\t\t\t\tWHERE\n\t\t\t\t\torientsstructs.personne_id = Personne.id\n\t\t\t\t\tAND orientsstructs.statut_orient = ''Orient\u00e9''\n\t\t\t\t\tAND (\n\t\t\t\t\t\tNOT EXISTS(\n\t\t\t\t\t\t\tSELECT *\n\t\t\t\t\t\t\t\tFROM orientsstructs AS osvt\n\t\t\t\t\t\t\t\t\tINNER JOIN typesorients AS tosvt ON ( tosvt.id = osvt.typeorient_id )\n\t\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\t\tosvt.personne_id = orientsstructs.personne_id\n\t\t\t\t\t\t\t\t\tAND osvt.statut_orient = ''Orient\u00e9''\n\t\t\t\t\t\t\t\t\tAND osvt.date_valid > orientsstructs.date_valid\n\t\t\t\t\t\t\t\t\tAND tosvt.parentid IN ( 1 )\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\tAND typesorients.parentid IN ( 4,6 )\n\t\t\t\t\tAND orientsstructs.date_valid <= ''2014-03-02''\n\t\t\t)"],{"1":["Contratinsertion.id NOT IN (\n\t\t\t\t\tSELECT contratsinsertion.id\n\t\t\t\t\t\tFROM contratsinsertion\n\t\t\t\t\t\t\tINNER JOIN bilansparcours66 ON (\n\t\t\t\t\t\t\t\tbilansparcours66.contratinsertion_id = contratsinsertion.id\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\tbilansparcours66.contratinsertion_id = Contratinsertion.id\n\t\t\t\t)"]},{"2":"Orientstruct.id IN ( SELECT \"orientsstructs\".\"id\" AS \"orientsstructs__id\" FROM \"orientsstructs\" AS \"orientsstructs\"   WHERE \"orientsstructs\".\"personne_id\" = \"Personne\".\"id\" AND \"orientsstructs\".\"statut_orient\" = ''Orient\u00e9'' AND \"orientsstructs\".\"date_valid\" IS NOT NULL   ORDER BY \"orientsstructs\".\"date_valid\" DESC  LIMIT 1 )"},{"Prestation.rolepers":["DEM","CJT"]},{"Calculdroitrsa.toppersdrodevorsa":"1"},{"Situationdossierrsa.etatdosrsa":["Z","2","3","4"]},{"3":"Adressefoyer.id IN ( SELECT \"adressesfoyers\".\"id\" AS \"adressesfoyers__id\" FROM \"adressesfoyers\" AS \"adressesfoyers\"   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"4":""},{"5":"Contratinsertion.id IN ( SELECT \"contratsinsertion\".\"id\" AS \"contratsinsertion__id\" FROM \"contratsinsertion\" AS \"contratsinsertion\"   WHERE \"contratsinsertion\".\"personne_id\" = \"Personne\".\"id\"   ORDER BY \"contratsinsertion\".\"dd_ci\" DESC  LIMIT 1 )"},{"6":"Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)"},{"7":"Orientstruct.id NOT IN (\n\t\t\t\tSELECT \"nonorientationsproseps66\".\"orientstruct_id\"\n\t\t\t\tFROM \"nonorientationsproseps66\"\n\t\t\t\t\tINNER JOIN \"dossierseps\" ON ( \"dossierseps\".\"id\" = \"nonorientationsproseps66\".\"dossierep_id\" )\n\t\t\t\tWHERE \"dossierseps\".\"id\" NOT IN (\n\t\t\t\t\tSELECT \"passagescommissionseps\".\"dossierep_id\"\n\t\t\t\t\tFROM passagescommissionseps\n\t\t\t\t\tWHERE \"passagescommissionseps\".\"etatdossierep\" = ''traite''\n\t\t\t\t)\n\t\t\t\tAND \"dossierseps\".\"themeep\" = ''nonorientationsproseps66''\n\t\t\t\tAND \"nonorientationsproseps66\".\"orientstruct_id\" = \"Orientstruct\".\"id\"\n\t\t\t)"},{"8":"Orientstruct.id NOT IN (\n\t\t\t\tSELECT nonorientationsproseps66.orientstruct_id\n\t\t\t\t\tFROM nonorientationsproseps66\n\t\t\t\t\t\tINNER JOIN dossierseps ON (\n\t\t\t\t\t\t\tnonorientationsproseps66.dossierep_id = dossierseps.id\n\t\t\t\t\t\t)\n\t\t\t\t\tWHERE\n\t\t\t\t\t\tnonorientationsproseps66.orientstruct_id = Orientstruct.id\n\t\t\t\t\t\tAND dossierseps.id IN (\n\t\t\t\t\t\t\tSELECT \"passagescommissionseps\".\"dossierep_id\"\n\t\t\t\t\t\t\tFROM passagescommissionseps\n\t\t\t\t\t\t\tWHERE \"passagescommissionseps\".\"etatdossierep\" = ''traite''\n\t\t\t\t\t\t)\n\t\t\t\t\t\tAND ( DATE( NOW() ) - (\n\t\t\t\t\t\t\tSELECT CAST( decisionsnonorientationsproseps66.modified AS DATE )\n\t\t\t\t\t\t\t\tFROM decisionsnonorientationsproseps66\n\t\t\t\t\t\t\t\t\tINNER JOIN passagescommissionseps ON ( decisionsnonorientationsproseps66.passagecommissionep_id = passagescommissionseps.id )\n\t\t\t\t\t\t\t\t\tINNER JOIN dossierseps ON ( passagescommissionseps.dossierep_id = dossierseps.id )\n\t\t\t\t\t\t\t\tORDER BY modified DESC\n\t\t\t\t\t\t\t\tLIMIT 1\n\t\t\t\t\t\t) ) <= 60\n\t\t\t)"},[]],"fields":{"Personne.dtnai":"Personne.dtnai","( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"":"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"","(\n\t\t\t\t\tCASE WHEN NOT\n\t\t\t\t\t(\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''DEM''\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t) = 1\n\t\t\t\t\t\tAND\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''CJT''\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t) <= 1\n\t\t\t\t\t) THEN (\n\t\t\t\t\t\t''Ce foyer comporte '' ||\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''DEM''\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t|| '' demandeur(s) et '' ||\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''CJT''\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) || '' conjoint(s).''\n\t\t\t\t\t) ELSE NULL\n\t\t\t\t\tEND\n\t\t\t\t) AS  \"Foyer__enerreur\"":"(\n\t\t\t\t\tCASE WHEN NOT\n\t\t\t\t\t(\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''DEM''\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t) = 1\n\t\t\t\t\t\tAND\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''CJT''\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t) <= 1\n\t\t\t\t\t) THEN (\n\t\t\t\t\t\t''Ce foyer comporte '' ||\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''DEM''\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t|| '' demandeur(s) et '' ||\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tSELECT COUNT(personnes.id)\n\t\t\t\t\t\t\t\t\tFROM personnes\n\t\t\t\t\t\t\t\t\t\tINNER JOIN prestations ON (\n\t\t\t\t\t\t\t\t\t\t\tprestations.personne_id = personnes.id\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.natprest = ''RSA''\n\t\t\t\t\t\t\t\t\t\t\tAND prestations.rolepers = ''CJT''\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tWHERE personnes.foyer_id = \"Foyer\".\"id\"\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) || '' conjoint(s).''\n\t\t\t\t\t) ELSE NULL\n\t\t\t\t\tEND\n\t\t\t\t) AS  \"Foyer__enerreur\"","Adresse.codepos":"Adresse.codepos","Dossier.numdemrsa":"Dossier.numdemrsa","Referentparcours.nom_complet":"( ( \"Referentparcours\".\"qual\" || '' '' || \"Referentparcours\".\"nom\" || '' '' || \"Referentparcours\".\"prenom\" ) ) AS \"Referentparcours__nom_complet\"","Structurereferenteparcours.lib_struc":"Structurereferenteparcours.lib_struc","Orientstruct.date_valid":"Orientstruct.date_valid","( \"Referent\".\"qual\" || '' '' || \"Referent\".\"nom\" || '' '' || \"Referent\".\"prenom\" ) AS  \"Referent__nom_complet\"":"( \"Referent\".\"qual\" || '' '' || \"Referent\".\"nom\" || '' '' || \"Referent\".\"prenom\" ) AS  \"Referent__nom_complet\"","Structurereferente.lib_struc":"Structurereferente.lib_struc","Typeorient.lib_type_orient":"Typeorient.lib_type_orient","DATE_PART( ''day'', NOW() - \"Contratinsertion\".\"df_ci\" ) AS  \"Contratinsertion__nbjours\"":"DATE_PART( ''day'', NOW() - \"Contratinsertion\".\"df_ci\" ) AS  \"Contratinsertion__nbjours\"","0":"Personne.id","1":"( COALESCE( \"Personne\".\"qual\", '''' ) || '' '' || \"Personne\".\"nom\" || '' '' || \"Personne\".\"prenom\" ) AS  \"Personne__nom_complet\"","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:24:59'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"structuresreferentes\"","alias":"Structurereferente","type":"INNER","conditions":"\"Orientstruct\".\"structurereferente_id\" = \"Structurereferente\".\"id\""},{"table":"\"typesorients\"","alias":"Typeorient","type":"INNER","conditions":"\"Orientstruct\".\"typeorient_id\" = \"Typeorient\".\"id\""},{"table":"\"referents\"","alias":"Referent","type":"LEFT OUTER","conditions":"\"Orientstruct\".\"referent_id\" = \"Referent\".\"id\""},{"table":"\"personnes\"","alias":"Personne","type":"INNER","conditions":"\"Orientstruct\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"INNER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"INNER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA'' AND \"Prestation\".\"rolepers\" IN (''DEM'', ''CJT'')"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"INNER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"INNER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"INNER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"contratsinsertion\"","alias":"Contratinsertion","type":"INNER","conditions":"\"Contratinsertion\".\"personne_id\" = \"Personne\".\"id\""}],"limit":11,"offset":0,"order":[""],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');

INSERT INTO requestsmanager (name, requestgroup_id, actif, model, json) VALUES ('Moteur de recherche par Allocataires sortants', 1, 1, 'Personne', '{"conditions":{"Adresse.numcom NOT LIKE":"66%","0":{"OR":{"Adresse2.numcom LIKE":"66%","Adresse3.numcom LIKE":"66%"}},"OR":{"Prestation.rolepers":["DEM","CJT"],"0":"Prestation.id IS NULL"},"1":"( Situationdossierrsa.etatdosrsa IN ( ''2'', ''3'', ''4'' ) )","2":"Dossier.id IN (\n\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.dossier_id\n\t\t\t\t\t\t\tFROM derniersdossiersallocataires\n\t\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\t\tderniersdossiersallocataires.personne_id = Personne.id\n\t\t\t\t\t)","3":[]},"fields":{"Personne.nom_complet":"Personne.nom_complet","Adressefoyer.dtemm":"Adressefoyer.dtemm","( COALESCE( \"Adresse\".\"codepos\", '''' ) || '' '' || COALESCE( \"Adresse\".\"nomcom\", '''' ) ) AS  \"Adresse__localite\"":"( COALESCE( \"Adresse\".\"codepos\", '''' ) || '' '' || COALESCE( \"Adresse\".\"nomcom\", '''' ) ) AS  \"Adresse__localite\"","Dossier.matricule":"Dossier.matricule","0":"Dossier.id","Adressefoyer2.dtemm":"Adressefoyer2.dtemm","Adresse2.localite":"( ( ( COALESCE( \"Adresse2\".\"codepos\", '''' ) || '' '' || COALESCE( \"Adresse2\".\"nomcom\", '''' ) ) ) ) AS \"Adresse2__localite\"","Adressefoyer3.dtemm":"Adressefoyer3.dtemm","Adresse3.localite":"( ( ( COALESCE( \"Adresse3\".\"codepos\", '''' ) || '' '' || COALESCE( \"Adresse3\".\"nomcom\", '''' ) ) ) ) AS \"Adresse3__localite\"","Dossier.locked":"( \"Dossier\".\"id\" IN ( SELECT \"jetons\".\"dossier_id\" AS \"jetons__dossier_id\" FROM \"jetons\" AS \"jetons\"   WHERE (NOT (\"jetons\".\"php_sid\" = ''od519i29tjmn1e5iruagj114k2'') AND NOT (\"jetons\".\"user_id\" = 432)) AND \"modified\" >= ''2016-02-21 16:25:35'' AND \"jetons\".\"dossier_id\" = \"Dossier\".\"id\"    ) ) AS \"Dossier__locked\""},"joins":[{"table":"\"foyers\"","alias":"Foyer","type":"INNER","conditions":"\"Personne\".\"foyer_id\" = \"Foyer\".\"id\""},{"table":"\"dossiers\"","alias":"Dossier","type":"INNER","conditions":"\"Foyer\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"calculsdroitsrsa\"","alias":"Calculdroitrsa","type":"LEFT OUTER","conditions":"\"Calculdroitrsa\".\"personne_id\" = \"Personne\".\"id\""},{"table":"\"prestations\"","alias":"Prestation","type":"LEFT OUTER","conditions":"\"Prestation\".\"personne_id\" = \"Personne\".\"id\" AND \"Prestation\".\"natprest\" = ''RSA''"},{"table":"\"adressesfoyers\"","alias":"Adressefoyer","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer\".\"id\" IN( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''01''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse","type":"LEFT OUTER","conditions":"\"Adressefoyer\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"situationsdossiersrsa\"","alias":"Situationdossierrsa","type":"INNER","conditions":"\"Situationdossierrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"detailsdroitsrsa\"","alias":"Detaildroitrsa","type":"LEFT OUTER","conditions":"\"Detaildroitrsa\".\"dossier_id\" = \"Dossier\".\"id\""},{"table":"\"adresses_cantons\"","alias":"AdresseCanton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"adresse_id\" = \"Adresse\".\"id\""},{"table":"\"cantons\"","alias":"Canton","type":"LEFT OUTER","conditions":"\"AdresseCanton\".\"canton_id\" = \"Canton\".\"id\""},{"table":"\"personnes_referents\"","alias":"PersonneReferent","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"personne_id\" = \"Personne\".\"id\" AND ((\"PersonneReferent\".\"id\" IS NULL) OR (\"PersonneReferent\".\"id\" IN ( SELECT \"personnes_referents\".\"id\"\n\t\t\t\t\tFROM personnes_referents\n\t\t\t\t\tWHERE\n\t\t\t\t\t\t\"personnes_referents\".\"personne_id\" = \"Personne\".\"id\"\n\t\t\t\t\t\tAND \"personnes_referents\".\"dfdesignation\" IS NULL\n\t\t\t\t\tORDER BY \"personnes_referents\".\"dddesignation\" DESC\n\t\t\t\t\tLIMIT 1 )))"},{"table":"\"referents\"","alias":"Referentparcours","type":"LEFT OUTER","conditions":"\"PersonneReferent\".\"referent_id\" = \"Referentparcours\".\"id\""},{"table":"\"structuresreferentes\"","alias":"Structurereferenteparcours","type":"LEFT OUTER","conditions":"\"Referentparcours\".\"structurereferente_id\" = \"Structurereferenteparcours\".\"id\""},{"table":"\"adressesfoyers\"","alias":"Adressefoyer2","type":"LEFT OUTER","conditions":"\"Adressefoyer2\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer2\".\"id\" IN ( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''02''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse2","type":"LEFT OUTER","conditions":"\"Adressefoyer2\".\"adresse_id\" = \"Adresse2\".\"id\""},{"table":"\"adressesfoyers\"","alias":"Adressefoyer3","type":"LEFT OUTER","conditions":"\"Adressefoyer3\".\"foyer_id\" = \"Foyer\".\"id\" AND \"Adressefoyer3\".\"id\" IN ( SELECT \"adressesfoyers\".\"id\" AS adressesfoyers__id FROM adressesfoyers AS adressesfoyers   WHERE \"adressesfoyers\".\"foyer_id\" = \"Foyer\".\"id\" AND \"adressesfoyers\".\"rgadr\" = ''03''   ORDER BY \"adressesfoyers\".\"dtemm\" DESC  LIMIT 1 )"},{"table":"\"adresses\"","alias":"Adresse3","type":"LEFT OUTER","conditions":"\"Adressefoyer3\".\"adresse_id\" = \"Adresse3\".\"id\""}],"limit":11,"offset":0,"order":[""],"page":1,"group":null,"callbacks":true,"maxLimit":100,"paramType":"named","contain":false,"recursive":-1}');


-- *****************************************************************************
COMMIT;
-- *****************************************************************************
